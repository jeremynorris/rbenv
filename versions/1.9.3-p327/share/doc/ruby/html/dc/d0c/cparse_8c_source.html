<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Ruby: ext/racc/cparse/cparse.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="../../index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="../../files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>ext/racc/cparse/cparse.c</h1><a href="../../dc/d0c/cparse_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"></span>
<a name="l00003"></a>00003 <span class="comment">    cparse.c -- Racc Runtime Core</span>
<a name="l00004"></a>00004 <span class="comment"></span>
<a name="l00005"></a>00005 <span class="comment">    Copyright (c) 1999-2006 Minero Aoki</span>
<a name="l00006"></a>00006 <span class="comment"></span>
<a name="l00007"></a>00007 <span class="comment">    This library is free software.</span>
<a name="l00008"></a>00008 <span class="comment">    You can distribute/modify this program under the same terms of ruby.</span>
<a name="l00009"></a>00009 <span class="comment"></span>
<a name="l00010"></a>00010 <span class="comment">    $originalId: cparse.c,v 1.8 2006/07/06 11:39:46 aamine Exp $</span>
<a name="l00011"></a>00011 <span class="comment"></span>
<a name="l00012"></a>00012 <span class="comment">*/</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="preprocessor">#include &quot;<a class="code" href="../../de/de6/ruby_2ruby_8h.html">ruby/ruby.h</a>&quot;</span>
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="preprocessor">#ifndef FALSE</span>
<a name="l00017"></a><a class="code" href="../../dc/d0c/cparse_8c.html#aa93f0eb578d23995850d61f7d61c55c1">00017</a> <span class="preprocessor"></span><span class="preprocessor">#define FALSE 0</span>
<a name="l00018"></a>00018 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00019"></a>00019 <span class="preprocessor"></span><span class="preprocessor">#ifndef TRUE</span>
<a name="l00020"></a><a class="code" href="../../dc/d0c/cparse_8c.html#aa8cecfc5c5c054d2875c03e77b7be15d">00020</a> <span class="preprocessor"></span><span class="preprocessor">#define TRUE 1</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span>
<a name="l00023"></a>00023 <span class="comment">/* -----------------------------------------------------------------------</span>
<a name="l00024"></a>00024 <span class="comment">                        Important Constants</span>
<a name="l00025"></a>00025 <span class="comment">----------------------------------------------------------------------- */</span>
<a name="l00026"></a>00026 
<a name="l00027"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a5c066a677833ce5c349a97b1481cedbb">00027</a> <span class="preprocessor">#define RACC_VERSION &quot;1.4.5&quot;</span>
<a name="l00028"></a>00028 <span class="preprocessor"></span>
<a name="l00029"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a591c65b850c87c3624119499f8c5fbc8">00029</a> <span class="preprocessor">#define DEFAULT_TOKEN -1</span>
<a name="l00030"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a2983b695e827265a5b46ab9405446e36">00030</a> <span class="preprocessor"></span><span class="preprocessor">#define ERROR_TOKEN    1</span>
<a name="l00031"></a><a class="code" href="../../dc/d0c/cparse_8c.html#aba2daa828eb0fd6b23b435586a3009e8">00031</a> <span class="preprocessor"></span><span class="preprocessor">#define FINAL_TOKEN    0</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span>
<a name="l00033"></a><a class="code" href="../../dc/d0c/cparse_8c.html#abf65dac98d02e19940039f936815d768">00033</a> <span class="preprocessor">#define vDEFAULT_TOKEN  INT2FIX(DEFAULT_TOKEN)</span>
<a name="l00034"></a><a class="code" href="../../dc/d0c/cparse_8c.html#adad73d4f4cbfbd263cc4049f9cb91e7f">00034</a> <span class="preprocessor"></span><span class="preprocessor">#define vERROR_TOKEN    INT2FIX(ERROR_TOKEN)</span>
<a name="l00035"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a5e50338806ed51c0cc84823ac4b8315e">00035</a> <span class="preprocessor"></span><span class="preprocessor">#define vFINAL_TOKEN    INT2FIX(FINAL_TOKEN)</span>
<a name="l00036"></a>00036 <span class="preprocessor"></span>
<a name="l00037"></a>00037 <span class="comment">/* -----------------------------------------------------------------------</span>
<a name="l00038"></a>00038 <span class="comment">                          File Local Variables</span>
<a name="l00039"></a>00039 <span class="comment">----------------------------------------------------------------------- */</span>
<a name="l00040"></a>00040 
<a name="l00041"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a384ab0d8c22f55bff306d4357d7b0482">00041</a> <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a384ab0d8c22f55bff306d4357d7b0482">RaccBug</a>;
<a name="l00042"></a><a class="code" href="../../dc/d0c/cparse_8c.html#ae670e17dbe6d63fad0031752be7c6c32">00042</a> <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../dc/d0c/cparse_8c.html#ae670e17dbe6d63fad0031752be7c6c32">CparseParams</a>;
<a name="l00043"></a>00043 
<a name="l00044"></a><a class="code" href="../../dc/d0c/cparse_8c.html#af4d1e2269c213f3cff294b1a19cd8733">00044</a> <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#afa5b9137f051ac26d7ccc8824f178233">ID</a> <a class="code" href="../../dc/d0c/cparse_8c.html#af4d1e2269c213f3cff294b1a19cd8733">id_yydebug</a>;
<a name="l00045"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a834be3eb5e540250a42734d7f4add8c2">00045</a> <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#afa5b9137f051ac26d7ccc8824f178233">ID</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a834be3eb5e540250a42734d7f4add8c2">id_nexttoken</a>;
<a name="l00046"></a><a class="code" href="../../dc/d0c/cparse_8c.html#ab3cf40d11f0dca0181034720feb0a83d">00046</a> <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#afa5b9137f051ac26d7ccc8824f178233">ID</a> <a class="code" href="../../dc/d0c/cparse_8c.html#ab3cf40d11f0dca0181034720feb0a83d">id_onerror</a>;
<a name="l00047"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a6800221fc9e6149fb97eeafc1e84947d">00047</a> <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#afa5b9137f051ac26d7ccc8824f178233">ID</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a6800221fc9e6149fb97eeafc1e84947d">id_noreduce</a>;
<a name="l00048"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a81ab42d71c85cea1f094aa863dec2712">00048</a> <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#afa5b9137f051ac26d7ccc8824f178233">ID</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a81ab42d71c85cea1f094aa863dec2712">id_errstatus</a>;
<a name="l00049"></a>00049 
<a name="l00050"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a23878f80efaea8fbf95436cdf58b84cd">00050</a> <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#afa5b9137f051ac26d7ccc8824f178233">ID</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a23878f80efaea8fbf95436cdf58b84cd">id_d_shift</a>;
<a name="l00051"></a><a class="code" href="../../dc/d0c/cparse_8c.html#acdc6520f31410be6234a6feaa7d20373">00051</a> <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#afa5b9137f051ac26d7ccc8824f178233">ID</a> <a class="code" href="../../dc/d0c/cparse_8c.html#acdc6520f31410be6234a6feaa7d20373">id_d_reduce</a>;
<a name="l00052"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a83eb2a82ce7b62c5d197b3077750e034">00052</a> <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#afa5b9137f051ac26d7ccc8824f178233">ID</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a83eb2a82ce7b62c5d197b3077750e034">id_d_accept</a>;
<a name="l00053"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a8a92a5a5a571730aefae6ac864ff80cf">00053</a> <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#afa5b9137f051ac26d7ccc8824f178233">ID</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a8a92a5a5a571730aefae6ac864ff80cf">id_d_read_token</a>;
<a name="l00054"></a><a class="code" href="../../dc/d0c/cparse_8c.html#aeae35d86a3ea05fc3831156492e8427e">00054</a> <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#afa5b9137f051ac26d7ccc8824f178233">ID</a> <a class="code" href="../../dc/d0c/cparse_8c.html#aeae35d86a3ea05fc3831156492e8427e">id_d_next_state</a>;
<a name="l00055"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a2de7e7e741e5e52a250760fd2e3f815a">00055</a> <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#afa5b9137f051ac26d7ccc8824f178233">ID</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a2de7e7e741e5e52a250760fd2e3f815a">id_d_e_pop</a>;
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 <span class="comment">/* -----------------------------------------------------------------------</span>
<a name="l00058"></a>00058 <span class="comment">                              Utils</span>
<a name="l00059"></a>00059 <span class="comment">----------------------------------------------------------------------- */</span>
<a name="l00060"></a>00060 
<a name="l00061"></a>00061 <span class="comment">/* For backward compatibility */</span>
<a name="l00062"></a>00062 <span class="preprocessor">#ifndef ID2SYM</span>
<a name="l00063"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a48bfb6519a45249fb2ec0193ea3b6e1c">00063</a> <span class="preprocessor"></span><span class="preprocessor"># define ID2SYM(i) ULONG2NUM(i)</span>
<a name="l00064"></a>00064 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00065"></a>00065 <span class="preprocessor"></span><span class="preprocessor">#ifndef SYM2ID</span>
<a name="l00066"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a73ce5202e6172d3ad0bab7d1e0df9dae">00066</a> <span class="preprocessor"></span><span class="preprocessor">#  define SYM2ID(v) ((ID)NUM2ULONG(v))</span>
<a name="l00067"></a>00067 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00068"></a>00068 <span class="preprocessor"></span><span class="preprocessor">#ifndef SYMBOL_P</span>
<a name="l00069"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a637bc5a232034ee3fd411f8bef091566">00069</a> <span class="preprocessor"></span><span class="preprocessor">#  define SYMBOL_P(v) FIXNUM_P(v)</span>
<a name="l00070"></a>00070 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00071"></a>00071 <span class="preprocessor"></span><span class="preprocessor">#ifndef LONG2NUM</span>
<a name="l00072"></a><a class="code" href="../../dc/d0c/cparse_8c.html#af1afba1194a12547a1e65d92abf03b03">00072</a> <span class="preprocessor"></span><span class="preprocessor">#  define LONG2NUM(i) INT2NUM(i)</span>
<a name="l00073"></a>00073 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00074"></a>00074 <span class="preprocessor"></span>
<a name="l00075"></a>00075 <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#afa5b9137f051ac26d7ccc8824f178233">ID</a> <a class="code" href="../../dc/d0c/cparse_8c.html#afdaacbe000e5d054bf114a77e08248a9">value_to_id</a> <a class="code" href="../../df/da8/dln_8h.html#a10087a068d10eaadb8f9bb9200cd619a">_</a>((<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> v));
<a name="l00076"></a>00076 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">long</span> <a class="code" href="../../dc/d0c/cparse_8c.html#a1d29c991a29cc368e49bfa491533c9c2">num_to_long</a> <a class="code" href="../../df/da8/dln_8h.html#a10087a068d10eaadb8f9bb9200cd619a">_</a>((<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> n));
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#afa5b9137f051ac26d7ccc8824f178233">ID</a>
<a name="l00079"></a><a class="code" href="../../dc/d0c/cparse_8c.html#afdaacbe000e5d054bf114a77e08248a9">00079</a> <a class="code" href="../../dc/d0c/cparse_8c.html#afdaacbe000e5d054bf114a77e08248a9">value_to_id</a>(<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> v)
<a name="l00080"></a>00080 {
<a name="l00081"></a>00081     <span class="keywordflow">if</span> (! <a class="code" href="../../dc/d0c/cparse_8c.html#a637bc5a232034ee3fd411f8bef091566">SYMBOL_P</a>(v)) {
<a name="l00082"></a>00082         <a class="code" href="../../db/dcc/error_8c.html#a0f771a2840561f1838169b3d7d4616f3">rb_raise</a>(<a class="code" href="../../db/dcc/error_8c.html#a565ed9d70f4089e1b4a36e9b3381b8c6">rb_eTypeError</a>, <span class="stringliteral">&quot;not symbol&quot;</span>);
<a name="l00083"></a>00083     }
<a name="l00084"></a>00084     <span class="keywordflow">return</span> <a class="code" href="../../dc/d0c/cparse_8c.html#a73ce5202e6172d3ad0bab7d1e0df9dae">SYM2ID</a>(v);
<a name="l00085"></a>00085 }
<a name="l00086"></a>00086 
<a name="l00087"></a>00087 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">long</span>
<a name="l00088"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a1d29c991a29cc368e49bfa491533c9c2">00088</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a1d29c991a29cc368e49bfa491533c9c2">num_to_long</a>(<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> n)
<a name="l00089"></a>00089 {
<a name="l00090"></a>00090     <span class="keywordflow">return</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a93f154f3dcc08027f475bf0c3cc287bd">NUM2LONG</a>(n);
<a name="l00091"></a>00091 }
<a name="l00092"></a>00092 
<a name="l00093"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a2c5302305d878024276c413652549eb9">00093</a> <span class="preprocessor">#define AREF(s, idx) \</span>
<a name="l00094"></a>00094 <span class="preprocessor">    ((0 &lt;= idx &amp;&amp; idx &lt; RARRAY_LEN(s)) ? RARRAY_PTR(s)[idx] : Qnil)</span>
<a name="l00095"></a>00095 <span class="preprocessor"></span>
<a name="l00096"></a>00096 <span class="comment">/* -----------------------------------------------------------------------</span>
<a name="l00097"></a>00097 <span class="comment">                        Parser Stack Interfaces</span>
<a name="l00098"></a>00098 <span class="comment">----------------------------------------------------------------------- */</span>
<a name="l00099"></a>00099 
<a name="l00100"></a>00100 <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a344f651be6b08dc0cfe98745ef06ff31">get_stack_tail</a> <a class="code" href="../../df/da8/dln_8h.html#a10087a068d10eaadb8f9bb9200cd619a">_</a>((<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> stack, <span class="keywordtype">long</span> <a class="code" href="../../d3/d15/name2ctype_8h.html#aed1cc4dca5d94cb452f79691f54f7423">len</a>));
<a name="l00101"></a>00101 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../dc/d0c/cparse_8c.html#a22007819ec3672e40a62d0514c3a4a11">cut_stack_tail</a> <a class="code" href="../../df/da8/dln_8h.html#a10087a068d10eaadb8f9bb9200cd619a">_</a>((<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> stack, <span class="keywordtype">long</span> <a class="code" href="../../d3/d15/name2ctype_8h.html#aed1cc4dca5d94cb452f79691f54f7423">len</a>));
<a name="l00102"></a>00102 
<a name="l00103"></a>00103 <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a>
<a name="l00104"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a344f651be6b08dc0cfe98745ef06ff31">00104</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a344f651be6b08dc0cfe98745ef06ff31">get_stack_tail</a>(<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> stack, <span class="keywordtype">long</span> <a class="code" href="../../d3/d15/name2ctype_8h.html#aed1cc4dca5d94cb452f79691f54f7423">len</a>)
<a name="l00105"></a>00105 {
<a name="l00106"></a>00106     <span class="keywordflow">if</span> (len &lt; 0) <span class="keywordflow">return</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a320970f989dc8294c8203154e3db40c1">Qnil</a>;  <span class="comment">/* system error */</span>
<a name="l00107"></a>00107     <span class="keywordflow">if</span> (len &gt; <a class="code" href="../../d8/df4/generator_8h.html#ae988773ed219452578f881fc7189c486">RARRAY_LEN</a>(stack)) len = <a class="code" href="../../d8/df4/generator_8h.html#ae988773ed219452578f881fc7189c486">RARRAY_LEN</a>(stack);
<a name="l00108"></a>00108     <span class="keywordflow">return</span> <a class="code" href="../../dc/dcc/array_8c.html#a575a99eebf6ce65893ed83c2b6783d2d">rb_ary_new4</a>(len, <a class="code" href="../../d8/df4/generator_8h.html#abb794fe2d7c73eea87e7ba2273939a8e">RARRAY_PTR</a>(stack) + <a class="code" href="../../d8/df4/generator_8h.html#ae988773ed219452578f881fc7189c486">RARRAY_LEN</a>(stack) - len);
<a name="l00109"></a>00109 }
<a name="l00110"></a>00110 
<a name="l00111"></a>00111 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00112"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a22007819ec3672e40a62d0514c3a4a11">00112</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a22007819ec3672e40a62d0514c3a4a11">cut_stack_tail</a>(<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> stack, <span class="keywordtype">long</span> <a class="code" href="../../d3/d15/name2ctype_8h.html#aed1cc4dca5d94cb452f79691f54f7423">len</a>)
<a name="l00113"></a>00113 {
<a name="l00114"></a>00114     <span class="keywordflow">while</span> (len &gt; 0) {
<a name="l00115"></a>00115         <a class="code" href="../../dc/dcc/array_8c.html#aacb1ec2239256ca2e537588fc534e7b8">rb_ary_pop</a>(stack);
<a name="l00116"></a>00116         len--;
<a name="l00117"></a>00117     }
<a name="l00118"></a>00118 }
<a name="l00119"></a>00119 
<a name="l00120"></a><a class="code" href="../../dc/d0c/cparse_8c.html#aa835c300f0894a81e232efbe991552fc">00120</a> <span class="preprocessor">#define STACK_INIT_LEN 64</span>
<a name="l00121"></a><a class="code" href="../../dc/d0c/cparse_8c.html#aaf0431a8462339e8b77f5d99df92f4ef">00121</a> <span class="preprocessor"></span><span class="preprocessor">#define NEW_STACK() rb_ary_new2(STACK_INIT_LEN)</span>
<a name="l00122"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a157327100ed3d158e8ff88c9506ba7b3">00122</a> <span class="preprocessor"></span><span class="preprocessor">#define PUSH(s, i) rb_ary_store(s, RARRAY_LEN(s), i)</span>
<a name="l00123"></a><a class="code" href="../../dc/d0c/cparse_8c.html#ab430e768f7286ab406613648c5658eff">00123</a> <span class="preprocessor"></span><span class="preprocessor">#define POP(s) rb_ary_pop(s)</span>
<a name="l00124"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a1c3e8e57f54d4a4caf5cbfef9a85cb69">00124</a> <span class="preprocessor"></span><span class="preprocessor">#define LAST_I(s) \</span>
<a name="l00125"></a>00125 <span class="preprocessor">    ((RARRAY_LEN(s) &gt; 0) ? RARRAY_PTR(s)[RARRAY_LEN(s) - 1] : Qnil)</span>
<a name="l00126"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a603fc30adeeffc9ce15a749d92ec0f1f">00126</a> <span class="preprocessor"></span><span class="preprocessor">#define GET_TAIL(s, len) get_stack_tail(s, len)</span>
<a name="l00127"></a><a class="code" href="../../dc/d0c/cparse_8c.html#adff91c561f0dd974151974f9da684b63">00127</a> <span class="preprocessor"></span><span class="preprocessor">#define CUT_TAIL(s, len) cut_stack_tail(s, len)</span>
<a name="l00128"></a>00128 <span class="preprocessor"></span>
<a name="l00129"></a>00129 <span class="comment">/* -----------------------------------------------------------------------</span>
<a name="l00130"></a>00130 <span class="comment">                       struct cparse_params</span>
<a name="l00131"></a>00131 <span class="comment">----------------------------------------------------------------------- */</span>
<a name="l00132"></a>00132 
<a name="l00133"></a><a class="code" href="../../d2/d6a/structcparse__params.html">00133</a> <span class="keyword">struct </span><a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a> {
<a name="l00134"></a><a class="code" href="../../d2/d6a/structcparse__params.html#ad4d64fc8a91da49f8afbff12fbb872c5">00134</a>     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d2/d6a/structcparse__params.html#ad4d64fc8a91da49f8afbff12fbb872c5">value_v</a>;         <span class="comment">/* VALUE version of this struct */</span>
<a name="l00135"></a>00135 
<a name="l00136"></a><a class="code" href="../../d2/d6a/structcparse__params.html#a5ab1ad36b90babc760699b47da3403e1">00136</a>     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d2/d6a/structcparse__params.html#a5ab1ad36b90babc760699b47da3403e1">parser</a>;          <span class="comment">/* parser object */</span>
<a name="l00137"></a>00137 
<a name="l00138"></a><a class="code" href="../../d2/d6a/structcparse__params.html#ae09bcbe9e4b9db85dda830263c97dec5">00138</a>     <span class="keywordtype">int</span>   <a class="code" href="../../d2/d6a/structcparse__params.html#ae09bcbe9e4b9db85dda830263c97dec5">lex_is_iterator</a>;
<a name="l00139"></a><a class="code" href="../../d2/d6a/structcparse__params.html#a7aef02d95b80bfd627dc12f50759a925">00139</a>     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d2/d6a/structcparse__params.html#a7aef02d95b80bfd627dc12f50759a925">lexer</a>;           <span class="comment">/* scanner object */</span>
<a name="l00140"></a><a class="code" href="../../d2/d6a/structcparse__params.html#aa3a6893a27caaa73df527d9b3a387e79">00140</a>     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#afa5b9137f051ac26d7ccc8824f178233">ID</a>    <a class="code" href="../../d2/d6a/structcparse__params.html#aa3a6893a27caaa73df527d9b3a387e79">lexmid</a>;          <span class="comment">/* name of scanner method (must be an iterator) */</span>
<a name="l00141"></a>00141 
<a name="l00142"></a>00142     <span class="comment">/* State transition tables (immutable)</span>
<a name="l00143"></a>00143 <span class="comment">       Data structure is from Dragon Book 4.9 */</span>
<a name="l00144"></a>00144     <span class="comment">/* action table */</span>
<a name="l00145"></a><a class="code" href="../../d2/d6a/structcparse__params.html#a56dc44b5d45a58967b1f21372577c7cf">00145</a>     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d2/d6a/structcparse__params.html#a56dc44b5d45a58967b1f21372577c7cf">action_table</a>;
<a name="l00146"></a><a class="code" href="../../d2/d6a/structcparse__params.html#a861d013af789f4528c0e287927a3a4a0">00146</a>     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d2/d6a/structcparse__params.html#a861d013af789f4528c0e287927a3a4a0">action_check</a>;
<a name="l00147"></a><a class="code" href="../../d2/d6a/structcparse__params.html#a68e1ae6cb0cc334bd4e91779b4e774a2">00147</a>     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d2/d6a/structcparse__params.html#a68e1ae6cb0cc334bd4e91779b4e774a2">action_default</a>;
<a name="l00148"></a><a class="code" href="../../d2/d6a/structcparse__params.html#a665885b75e904b3aa99820b0bb1e5e0d">00148</a>     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d2/d6a/structcparse__params.html#a665885b75e904b3aa99820b0bb1e5e0d">action_pointer</a>;
<a name="l00149"></a>00149     <span class="comment">/* goto table */</span>
<a name="l00150"></a><a class="code" href="../../d2/d6a/structcparse__params.html#aebb4301cbc7097fef44beb85c87028f5">00150</a>     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d2/d6a/structcparse__params.html#aebb4301cbc7097fef44beb85c87028f5">goto_table</a>;
<a name="l00151"></a><a class="code" href="../../d2/d6a/structcparse__params.html#a85a7c77cae6772f8fbf3058404511f50">00151</a>     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d2/d6a/structcparse__params.html#a85a7c77cae6772f8fbf3058404511f50">goto_check</a>;
<a name="l00152"></a><a class="code" href="../../d2/d6a/structcparse__params.html#a7fe1eb04943a6ca4a031ccc20b6fb444">00152</a>     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d2/d6a/structcparse__params.html#a7fe1eb04943a6ca4a031ccc20b6fb444">goto_default</a>;
<a name="l00153"></a><a class="code" href="../../d2/d6a/structcparse__params.html#abf10f0546f4fd80796daaf4305cfa620">00153</a>     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d2/d6a/structcparse__params.html#abf10f0546f4fd80796daaf4305cfa620">goto_pointer</a>;
<a name="l00154"></a>00154 
<a name="l00155"></a><a class="code" href="../../d2/d6a/structcparse__params.html#a90e41fcba354aaec8301f0e22ed4b5e6">00155</a>     <span class="keywordtype">long</span>  <a class="code" href="../../d2/d6a/structcparse__params.html#a90e41fcba354aaec8301f0e22ed4b5e6">nt_base</a>;         <span class="comment">/* NonTerminal BASE index */</span>
<a name="l00156"></a><a class="code" href="../../d2/d6a/structcparse__params.html#a86095a9b0442d4e61657877faa62771e">00156</a>     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d2/d6a/structcparse__params.html#a86095a9b0442d4e61657877faa62771e">reduce_table</a>;    <span class="comment">/* reduce data table */</span>
<a name="l00157"></a><a class="code" href="../../d2/d6a/structcparse__params.html#a4c2ca44a98a76de960f132c83ae1ec0c">00157</a>     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d2/d6a/structcparse__params.html#a4c2ca44a98a76de960f132c83ae1ec0c">token_table</a>;     <span class="comment">/* token conversion table */</span>
<a name="l00158"></a>00158 
<a name="l00159"></a>00159     <span class="comment">/* parser stacks and parameters */</span>
<a name="l00160"></a><a class="code" href="../../d2/d6a/structcparse__params.html#a23011040bbcce8a521e1edd97e7f8d36">00160</a>     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d5/d1d/gb18030_8c.html#adc6e5733fc3c22f0a7b2914188c49c90">state</a>;
<a name="l00161"></a><a class="code" href="../../d2/d6a/structcparse__params.html#a470e16b3d782757846c3481ddcf87e80">00161</a>     <span class="keywordtype">long</span> <a class="code" href="../../d2/d6a/structcparse__params.html#a470e16b3d782757846c3481ddcf87e80">curstate</a>;
<a name="l00162"></a><a class="code" href="../../d2/d6a/structcparse__params.html#a8439f142d455ec7f89dcfc529474fc98">00162</a>     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d2/d6a/structcparse__params.html#a8439f142d455ec7f89dcfc529474fc98">vstack</a>;
<a name="l00163"></a><a class="code" href="../../d2/d6a/structcparse__params.html#a057b5bc3450b324219ca9694e1d03907">00163</a>     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d2/d6a/structcparse__params.html#a057b5bc3450b324219ca9694e1d03907">tstack</a>;
<a name="l00164"></a><a class="code" href="../../d2/d6a/structcparse__params.html#ab04916133be3d87a36cd5d76531e61e9">00164</a>     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d2/d6a/structcparse__params.html#ab04916133be3d87a36cd5d76531e61e9">t</a>;
<a name="l00165"></a><a class="code" href="../../d2/d6a/structcparse__params.html#a179990d4dca0745db768fbe9ed43534a">00165</a>     <span class="keywordtype">long</span> <a class="code" href="../../d2/d6a/structcparse__params.html#a179990d4dca0745db768fbe9ed43534a">shift_n</a>;
<a name="l00166"></a><a class="code" href="../../d2/d6a/structcparse__params.html#aad3974d836e4912e7d0d4dfc38dd3ad9">00166</a>     <span class="keywordtype">long</span> <a class="code" href="../../d2/d6a/structcparse__params.html#aad3974d836e4912e7d0d4dfc38dd3ad9">reduce_n</a>;
<a name="l00167"></a><a class="code" href="../../d2/d6a/structcparse__params.html#a223a9b75b69daefedddc3a26583020cb">00167</a>     <span class="keywordtype">long</span> <a class="code" href="../../d2/d6a/structcparse__params.html#a223a9b75b69daefedddc3a26583020cb">ruleno</a>;
<a name="l00168"></a>00168 
<a name="l00169"></a><a class="code" href="../../d2/d6a/structcparse__params.html#a5f228c7ab6c975d5d02bb7f227276270">00169</a>     <span class="keywordtype">long</span> <a class="code" href="../../d2/d6a/structcparse__params.html#a5f228c7ab6c975d5d02bb7f227276270">errstatus</a>;         <span class="comment">/* nonzero in error recovering mode */</span>
<a name="l00170"></a><a class="code" href="../../d2/d6a/structcparse__params.html#a7d3e36ab7f30cdfb535f44d21a18c431">00170</a>     <span class="keywordtype">long</span> <a class="code" href="../../d2/d6a/structcparse__params.html#a7d3e36ab7f30cdfb535f44d21a18c431">nerr</a>;              <span class="comment">/* number of error */</span>
<a name="l00171"></a>00171 
<a name="l00172"></a><a class="code" href="../../d2/d6a/structcparse__params.html#a37f41f8efcc1db46af71045593d630e9">00172</a>     <span class="keywordtype">int</span> <a class="code" href="../../d2/d6a/structcparse__params.html#a37f41f8efcc1db46af71045593d630e9">use_result_var</a>;
<a name="l00173"></a>00173 
<a name="l00174"></a><a class="code" href="../../d2/d6a/structcparse__params.html#a3eae0e73549f7dd9a4c136b154b02f69">00174</a>     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d2/d6a/structcparse__params.html#a3eae0e73549f7dd9a4c136b154b02f69">retval</a>;           <span class="comment">/* return value of parser routine */</span>
<a name="l00175"></a><a class="code" href="../../d2/d6a/structcparse__params.html#a211b8fd07c366b3621db91530a2efc03">00175</a>     <span class="keywordtype">long</span> <a class="code" href="../../d2/d6a/structcparse__params.html#a211b8fd07c366b3621db91530a2efc03">fin</a>;               <span class="comment">/* parse result status */</span>
<a name="l00176"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a05254fd484bcb6537b214490246237a1">00176</a> <span class="preprocessor">#define CP_FIN_ACCEPT  1</span>
<a name="l00177"></a><a class="code" href="../../dc/d0c/cparse_8c.html#ad45dfea4a0104d3d7b1e841e9894f48a">00177</a> <span class="preprocessor"></span><span class="preprocessor">#define CP_FIN_EOT     2</span>
<a name="l00178"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a5ec0f7cece638b5a69b1c927f2b21965">00178</a> <span class="preprocessor"></span><span class="preprocessor">#define CP_FIN_CANTPOP 3</span>
<a name="l00179"></a>00179 <span class="preprocessor"></span>
<a name="l00180"></a><a class="code" href="../../d2/d6a/structcparse__params.html#a1f5ed6eb5c79dc3282a92f54e918b7b6">00180</a>     <span class="keywordtype">int</span> <a class="code" href="../../d2/d6a/structcparse__params.html#a1f5ed6eb5c79dc3282a92f54e918b7b6">debug</a>;              <span class="comment">/* user level debug */</span>
<a name="l00181"></a><a class="code" href="../../d2/d6a/structcparse__params.html#a7668f25e694a055e3a989e7bcc06f0f9">00181</a>     <span class="keywordtype">int</span> <a class="code" href="../../d2/d6a/structcparse__params.html#a7668f25e694a055e3a989e7bcc06f0f9">sys_debug</a>;          <span class="comment">/* system level debug */</span>
<a name="l00182"></a>00182 
<a name="l00183"></a><a class="code" href="../../d2/d6a/structcparse__params.html#ade9d6b574497062464b543e71a5424e0">00183</a>     <span class="keywordtype">long</span> <a class="code" href="../../d2/d6a/structcparse__params.html#ade9d6b574497062464b543e71a5424e0">i</a>;                 <span class="comment">/* table index */</span>
<a name="l00184"></a>00184 };
<a name="l00185"></a>00185 
<a name="l00186"></a>00186 <span class="comment">/* -----------------------------------------------------------------------</span>
<a name="l00187"></a>00187 <span class="comment">                        Parser Main Routines</span>
<a name="l00188"></a>00188 <span class="comment">----------------------------------------------------------------------- */</span>
<a name="l00189"></a>00189 
<a name="l00190"></a>00190 <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../dc/d0c/cparse_8c.html#ae945376ef8cf004f20dda6002164bed5">racc_cparse</a> <a class="code" href="../../df/da8/dln_8h.html#a10087a068d10eaadb8f9bb9200cd619a">_</a>((<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> parser, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> arg, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> sysdebug));
<a name="l00191"></a>00191 <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a0a46104fc0afced976fd3c4887ee56f7">racc_yyparse</a> <a class="code" href="../../df/da8/dln_8h.html#a10087a068d10eaadb8f9bb9200cd619a">_</a>((<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> parser, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> lexer, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> lexmid,
<a name="l00192"></a>00192                              <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> arg, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> sysdebug));
<a name="l00193"></a>00193 
<a name="l00194"></a>00194 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../dc/d0c/cparse_8c.html#a851237a7193af92505c80ac9a204024e">call_lexer</a> <a class="code" href="../../df/da8/dln_8h.html#a10087a068d10eaadb8f9bb9200cd619a">_</a>((<span class="keyword">struct</span> <a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a> *v));
<a name="l00195"></a>00195 <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a7e4583311c631e0d59db73404ab9cb3c">lexer_i</a> <a class="code" href="../../df/da8/dln_8h.html#a10087a068d10eaadb8f9bb9200cd619a">_</a>((<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> block_args, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> data, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <span class="keyword">self</span>));
<a name="l00196"></a>00196 
<a name="l00197"></a>00197 <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../dc/d0c/cparse_8c.html#ad42d6b1672bcfabadccf70ead72e25df">assert_array</a> <a class="code" href="../../df/da8/dln_8h.html#a10087a068d10eaadb8f9bb9200cd619a">_</a>((<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> a));
<a name="l00198"></a>00198 <span class="keyword">static</span> <span class="keywordtype">long</span> <a class="code" href="../../dc/d0c/cparse_8c.html#a24fbcb71b2b677086150d6eb1c00b691">assert_integer</a> <a class="code" href="../../df/da8/dln_8h.html#a10087a068d10eaadb8f9bb9200cd619a">_</a>((<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> n));
<a name="l00199"></a>00199 <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../dc/d0c/cparse_8c.html#af0e54309073a0856e18157fd1b21fc73">assert_hash</a> <a class="code" href="../../df/da8/dln_8h.html#a10087a068d10eaadb8f9bb9200cd619a">_</a>((<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> h));
<a name="l00200"></a>00200 <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a7f60694053c7b2aa5f73f58120af1d04">initialize_params</a> <a class="code" href="../../df/da8/dln_8h.html#a10087a068d10eaadb8f9bb9200cd619a">_</a>((<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> vparams, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> parser, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> arg,
<a name="l00201"></a>00201                                  <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> lexer, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> lexmid));
<a name="l00202"></a>00202 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../dc/d0c/cparse_8c.html#a995defe6c4937c73497142fdaf9a186f">cparse_params_mark</a> <a class="code" href="../../df/da8/dln_8h.html#a10087a068d10eaadb8f9bb9200cd619a">_</a>((<span class="keywordtype">void</span> *ptr));
<a name="l00203"></a>00203 
<a name="l00204"></a>00204 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../dc/d0c/cparse_8c.html#aa31d084b704687b81f44c762bf358b30">parse_main</a> <a class="code" href="../../df/da8/dln_8h.html#a10087a068d10eaadb8f9bb9200cd619a">_</a>((<span class="keyword">struct</span> <a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a> *v,
<a name="l00205"></a>00205                          <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d5/d11/ripper_8c.html#a2b3a335d617ec14d6296ca82d3055858">tok</a>, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> val, <span class="keywordtype">int</span> resume));
<a name="l00206"></a>00206 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../dc/d0c/cparse_8c.html#a0d7724e1af9cfd9a9120ea10d4227778">extract_user_token</a> <a class="code" href="../../df/da8/dln_8h.html#a10087a068d10eaadb8f9bb9200cd619a">_</a>((<span class="keyword">struct</span> <a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a> *v,
<a name="l00207"></a>00207                                   <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> block_args, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> *<a class="code" href="../../d5/d11/ripper_8c.html#a2b3a335d617ec14d6296ca82d3055858">tok</a>, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> *val));
<a name="l00208"></a>00208 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../dc/d0c/cparse_8c.html#ae2e438d537892aeadba05c15eefbe89d">shift</a> <a class="code" href="../../df/da8/dln_8h.html#a10087a068d10eaadb8f9bb9200cd619a">_</a>((<span class="keyword">struct</span> <a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a>* v, <span class="keywordtype">long</span> act, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d5/d11/ripper_8c.html#a2b3a335d617ec14d6296ca82d3055858">tok</a>, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> val));
<a name="l00209"></a>00209 <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../dc/d0c/cparse_8c.html#a76d696c4b420b56a6694162a4f8eb38b">reduce</a> <a class="code" href="../../df/da8/dln_8h.html#a10087a068d10eaadb8f9bb9200cd619a">_</a>((<span class="keyword">struct</span> <a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a>* v, <span class="keywordtype">long</span> act));
<a name="l00210"></a>00210 <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a5ed2883f827f6e9773e4692c9825156f">reduce0</a> <a class="code" href="../../df/da8/dln_8h.html#a10087a068d10eaadb8f9bb9200cd619a">_</a>((<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> block_args, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> data, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <span class="keyword">self</span>));
<a name="l00211"></a>00211 
<a name="l00212"></a>00212 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l00213"></a>00213 <span class="preprocessor"></span><span class="preprocessor"># define D_puts(msg)        if (v-&gt;sys_debug) puts(msg)</span>
<a name="l00214"></a>00214 <span class="preprocessor"></span><span class="preprocessor"># define D_printf(fmt,arg)  if (v-&gt;sys_debug) printf(fmt,arg)</span>
<a name="l00215"></a>00215 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00216"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">00216</a> <span class="preprocessor"></span><span class="preprocessor"># define D_puts(msg)</span>
<a name="l00217"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a999aa703b22abcfb932f3baaeaec0f4a">00217</a> <span class="preprocessor"></span><span class="preprocessor"># define D_printf(fmt,arg)</span>
<a name="l00218"></a>00218 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00219"></a>00219 <span class="preprocessor"></span>
<a name="l00220"></a>00220 <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a>
<a name="l00221"></a><a class="code" href="../../dc/d0c/cparse_8c.html#ae945376ef8cf004f20dda6002164bed5">00221</a> <a class="code" href="../../dc/d0c/cparse_8c.html#ae945376ef8cf004f20dda6002164bed5">racc_cparse</a>(<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> parser, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> arg, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> sysdebug)
<a name="l00222"></a>00222 {
<a name="l00223"></a>00223     <span class="keyword">volatile</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> vparams;
<a name="l00224"></a>00224     <span class="keyword">struct </span><a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a> *v;
<a name="l00225"></a>00225 
<a name="l00226"></a>00226     vparams = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#ad80ce51081780f829134de0338821b76">Data_Make_Struct</a>(<a class="code" href="../../dc/d0c/cparse_8c.html#ae670e17dbe6d63fad0031752be7c6c32">CparseParams</a>, <span class="keyword">struct</span> <a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a>,
<a name="l00227"></a>00227                                <a class="code" href="../../dc/d0c/cparse_8c.html#a995defe6c4937c73497142fdaf9a186f">cparse_params_mark</a>, -1, v);
<a name="l00228"></a>00228     <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;starting cparse&quot;</span>);
<a name="l00229"></a>00229     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a7668f25e694a055e3a989e7bcc06f0f9">sys_debug</a> = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a117741045763c090b26e30a85bd0e0a6">RTEST</a>(sysdebug);
<a name="l00230"></a>00230     vparams = <a class="code" href="../../dc/d0c/cparse_8c.html#a7f60694053c7b2aa5f73f58120af1d04">initialize_params</a>(vparams, parser, arg, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a320970f989dc8294c8203154e3db40c1">Qnil</a>, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a320970f989dc8294c8203154e3db40c1">Qnil</a>);
<a name="l00231"></a>00231     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ae09bcbe9e4b9db85dda830263c97dec5">lex_is_iterator</a> = <a class="code" href="../../d1/d5c/nkf_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00232"></a>00232     <a class="code" href="../../dc/d0c/cparse_8c.html#aa31d084b704687b81f44c762bf358b30">parse_main</a>(v, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a320970f989dc8294c8203154e3db40c1">Qnil</a>, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a320970f989dc8294c8203154e3db40c1">Qnil</a>, 0);
<a name="l00233"></a>00233 
<a name="l00234"></a>00234     <span class="keywordflow">return</span> v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a3eae0e73549f7dd9a4c136b154b02f69">retval</a>;
<a name="l00235"></a>00235 }
<a name="l00236"></a>00236 
<a name="l00237"></a>00237 <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a>
<a name="l00238"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a0a46104fc0afced976fd3c4887ee56f7">00238</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a0a46104fc0afced976fd3c4887ee56f7">racc_yyparse</a>(<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d2/d6a/structcparse__params.html#a5ab1ad36b90babc760699b47da3403e1">parser</a>, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d2/d6a/structcparse__params.html#a7aef02d95b80bfd627dc12f50759a925">lexer</a>, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d2/d6a/structcparse__params.html#aa3a6893a27caaa73df527d9b3a387e79">lexmid</a>, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> arg, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> sysdebug)
<a name="l00239"></a>00239 {
<a name="l00240"></a>00240     <span class="keyword">volatile</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> vparams;
<a name="l00241"></a>00241     <span class="keyword">struct </span><a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a> *v;
<a name="l00242"></a>00242 
<a name="l00243"></a>00243     vparams = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#ad80ce51081780f829134de0338821b76">Data_Make_Struct</a>(<a class="code" href="../../dc/d0c/cparse_8c.html#ae670e17dbe6d63fad0031752be7c6c32">CparseParams</a>, <span class="keyword">struct</span> <a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a>,
<a name="l00244"></a>00244                                <a class="code" href="../../dc/d0c/cparse_8c.html#a995defe6c4937c73497142fdaf9a186f">cparse_params_mark</a>, -1, v);
<a name="l00245"></a>00245     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a7668f25e694a055e3a989e7bcc06f0f9">sys_debug</a> = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a117741045763c090b26e30a85bd0e0a6">RTEST</a>(sysdebug);
<a name="l00246"></a>00246     <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;start C yyparse&quot;</span>);
<a name="l00247"></a>00247     vparams = <a class="code" href="../../dc/d0c/cparse_8c.html#a7f60694053c7b2aa5f73f58120af1d04">initialize_params</a>(vparams, parser, arg, lexer, lexmid);
<a name="l00248"></a>00248     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ae09bcbe9e4b9db85dda830263c97dec5">lex_is_iterator</a> = <a class="code" href="../../d1/d5c/nkf_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00249"></a>00249     <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;params initialized&quot;</span>);
<a name="l00250"></a>00250     <a class="code" href="../../dc/d0c/cparse_8c.html#aa31d084b704687b81f44c762bf358b30">parse_main</a>(v, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a320970f989dc8294c8203154e3db40c1">Qnil</a>, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a320970f989dc8294c8203154e3db40c1">Qnil</a>, 0);
<a name="l00251"></a>00251     <a class="code" href="../../dc/d0c/cparse_8c.html#a851237a7193af92505c80ac9a204024e">call_lexer</a>(v);
<a name="l00252"></a>00252     <span class="keywordflow">if</span> (!v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a211b8fd07c366b3621db91530a2efc03">fin</a>) {
<a name="l00253"></a>00253         <a class="code" href="../../db/dcc/error_8c.html#a0f771a2840561f1838169b3d7d4616f3">rb_raise</a>(<a class="code" href="../../db/dcc/error_8c.html#ab5e2a9fec766c75176fbb262bfe6a596">rb_eArgError</a>, <span class="stringliteral">&quot;%s() is finished before EndOfToken&quot;</span>,
<a name="l00254"></a>00254                  <a class="code" href="../../d5/d11/ripper_8c.html#a877bc58c495643fcf49dc64c44631e72">rb_id2name</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#aa3a6893a27caaa73df527d9b3a387e79">lexmid</a>));
<a name="l00255"></a>00255     }
<a name="l00256"></a>00256 
<a name="l00257"></a>00257     <span class="keywordflow">return</span> v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a3eae0e73549f7dd9a4c136b154b02f69">retval</a>;
<a name="l00258"></a>00258 }
<a name="l00259"></a>00259 
<a name="l00260"></a>00260 <span class="preprocessor">#ifdef HAVE_RB_BLOCK_CALL</span>
<a name="l00261"></a>00261 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00262"></a>00262 <a class="code" href="../../dc/d0c/cparse_8c.html#a851237a7193af92505c80ac9a204024e">call_lexer</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a> *v)
<a name="l00263"></a>00263 {
<a name="l00264"></a>00264     <a class="code" href="../../d8/d81/ruby__missing_8h.html#a57ef4ad7ebd72a2a8bc8d68e38439db5">rb_block_call</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a7aef02d95b80bfd627dc12f50759a925">lexer</a>, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#aa3a6893a27caaa73df527d9b3a387e79">lexmid</a>, 0, NULL, <a class="code" href="../../dc/d0c/cparse_8c.html#a7e4583311c631e0d59db73404ab9cb3c">lexer_i</a>, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ad4d64fc8a91da49f8afbff12fbb872c5">value_v</a>);
<a name="l00265"></a>00265 }
<a name="l00266"></a>00266 <span class="preprocessor">#else</span>
<a name="l00267"></a>00267 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a>
<a name="l00268"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a8fdcba0d78c45b778414918998102522">00268</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a8fdcba0d78c45b778414918998102522">lexer_iter</a>(<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> data)
<a name="l00269"></a>00269 {
<a name="l00270"></a>00270     <span class="keyword">struct </span><a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a> *v;
<a name="l00271"></a>00271 
<a name="l00272"></a>00272     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#ad043eb0996705571cad2e5bb39e9675e">Data_Get_Struct</a>(data, <span class="keyword">struct</span> <a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a>, v);
<a name="l00273"></a>00273     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a6a973fe624aa9aa9ba0cdeb6792d3187" title="Calls a method.">rb_funcall</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a7aef02d95b80bfd627dc12f50759a925">lexer</a>, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#aa3a6893a27caaa73df527d9b3a387e79">lexmid</a>, 0);
<a name="l00274"></a>00274     <span class="keywordflow">return</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a320970f989dc8294c8203154e3db40c1">Qnil</a>;
<a name="l00275"></a>00275 }
<a name="l00276"></a>00276 
<a name="l00277"></a>00277 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00278"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a851237a7193af92505c80ac9a204024e">00278</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a851237a7193af92505c80ac9a204024e">call_lexer</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a> *v)
<a name="l00279"></a>00279 {
<a name="l00280"></a>00280     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#afea09dbabdc6d85523d774fac9606e34">rb_iterate</a>(<a class="code" href="../../dc/d0c/cparse_8c.html#a8fdcba0d78c45b778414918998102522">lexer_iter</a>, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ad4d64fc8a91da49f8afbff12fbb872c5">value_v</a>, <a class="code" href="../../dc/d0c/cparse_8c.html#a7e4583311c631e0d59db73404ab9cb3c">lexer_i</a>, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ad4d64fc8a91da49f8afbff12fbb872c5">value_v</a>);
<a name="l00281"></a>00281 }
<a name="l00282"></a>00282 <span class="preprocessor">#endif</span>
<a name="l00283"></a>00283 <span class="preprocessor"></span>
<a name="l00284"></a>00284 <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a>
<a name="l00285"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a7e4583311c631e0d59db73404ab9cb3c">00285</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a7e4583311c631e0d59db73404ab9cb3c">lexer_i</a>(<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> block_args, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> data, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <span class="keyword">self</span>)
<a name="l00286"></a>00286 {
<a name="l00287"></a>00287     <span class="keyword">struct </span><a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a> *v;
<a name="l00288"></a>00288     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d5/d11/ripper_8c.html#a2b3a335d617ec14d6296ca82d3055858">tok</a>, val;
<a name="l00289"></a>00289 
<a name="l00290"></a>00290     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#ad043eb0996705571cad2e5bb39e9675e">Data_Get_Struct</a>(data, <span class="keyword">struct</span> <a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a>, v);
<a name="l00291"></a>00291     <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a211b8fd07c366b3621db91530a2efc03">fin</a>)
<a name="l00292"></a>00292         <a class="code" href="../../db/dcc/error_8c.html#a0f771a2840561f1838169b3d7d4616f3">rb_raise</a>(<a class="code" href="../../db/dcc/error_8c.html#ab5e2a9fec766c75176fbb262bfe6a596">rb_eArgError</a>, <span class="stringliteral">&quot;extra token after EndOfToken&quot;</span>);
<a name="l00293"></a>00293     <a class="code" href="../../dc/d0c/cparse_8c.html#a0d7724e1af9cfd9a9120ea10d4227778">extract_user_token</a>(v, block_args, &amp;tok, &amp;val);
<a name="l00294"></a>00294     <a class="code" href="../../dc/d0c/cparse_8c.html#aa31d084b704687b81f44c762bf358b30">parse_main</a>(v, tok, val, 1);
<a name="l00295"></a>00295     <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a211b8fd07c366b3621db91530a2efc03">fin</a> &amp;&amp; v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a211b8fd07c366b3621db91530a2efc03">fin</a> != <a class="code" href="../../dc/d0c/cparse_8c.html#a05254fd484bcb6537b214490246237a1">CP_FIN_ACCEPT</a>)
<a name="l00296"></a>00296        <a class="code" href="../../de/de9/vm_8c.html#a2d68db6481cad1995cbdb77a8ddd5291">rb_iter_break</a>();
<a name="l00297"></a>00297     <span class="keywordflow">return</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a320970f989dc8294c8203154e3db40c1">Qnil</a>;
<a name="l00298"></a>00298 }
<a name="l00299"></a>00299 
<a name="l00300"></a>00300 <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a>
<a name="l00301"></a><a class="code" href="../../dc/d0c/cparse_8c.html#ad42d6b1672bcfabadccf70ead72e25df">00301</a> <a class="code" href="../../dc/d0c/cparse_8c.html#ad42d6b1672bcfabadccf70ead72e25df">assert_array</a>(<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> a)
<a name="l00302"></a>00302 {
<a name="l00303"></a>00303     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#ad5a1e03b0a66824f95f6aaf07b4a4052">Check_Type</a>(a, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#abbd332f6f94d77e0a369c7720128639e">T_ARRAY</a>);
<a name="l00304"></a>00304     <span class="keywordflow">return</span> a;
<a name="l00305"></a>00305 }
<a name="l00306"></a>00306 
<a name="l00307"></a>00307 <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a>
<a name="l00308"></a><a class="code" href="../../dc/d0c/cparse_8c.html#af0e54309073a0856e18157fd1b21fc73">00308</a> <a class="code" href="../../dc/d0c/cparse_8c.html#af0e54309073a0856e18157fd1b21fc73">assert_hash</a>(<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> h)
<a name="l00309"></a>00309 {
<a name="l00310"></a>00310     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#ad5a1e03b0a66824f95f6aaf07b4a4052">Check_Type</a>(h, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a8357e81bbb60cb41b0a292a90653a5e5">T_HASH</a>);
<a name="l00311"></a>00311     <span class="keywordflow">return</span> h;
<a name="l00312"></a>00312 }
<a name="l00313"></a>00313 
<a name="l00314"></a>00314 <span class="keyword">static</span> <span class="keywordtype">long</span>
<a name="l00315"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a24fbcb71b2b677086150d6eb1c00b691">00315</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a24fbcb71b2b677086150d6eb1c00b691">assert_integer</a>(<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> n)
<a name="l00316"></a>00316 {
<a name="l00317"></a>00317     <span class="keywordflow">return</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a93f154f3dcc08027f475bf0c3cc287bd">NUM2LONG</a>(n);
<a name="l00318"></a>00318 }
<a name="l00319"></a>00319 
<a name="l00320"></a>00320 <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a>
<a name="l00321"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a7f60694053c7b2aa5f73f58120af1d04">00321</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a7f60694053c7b2aa5f73f58120af1d04">initialize_params</a>(<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> vparams, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d2/d6a/structcparse__params.html#a5ab1ad36b90babc760699b47da3403e1">parser</a>, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> arg, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d2/d6a/structcparse__params.html#a7aef02d95b80bfd627dc12f50759a925">lexer</a>, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d2/d6a/structcparse__params.html#aa3a6893a27caaa73df527d9b3a387e79">lexmid</a>)
<a name="l00322"></a>00322 {
<a name="l00323"></a>00323     <span class="keyword">struct </span><a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a> *v;
<a name="l00324"></a>00324 
<a name="l00325"></a>00325     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#ad043eb0996705571cad2e5bb39e9675e">Data_Get_Struct</a>(vparams, <span class="keyword">struct</span> <a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a>, v);
<a name="l00326"></a>00326     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ad4d64fc8a91da49f8afbff12fbb872c5">value_v</a> = vparams;
<a name="l00327"></a>00327     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5ab1ad36b90babc760699b47da3403e1">parser</a> = parser;
<a name="l00328"></a>00328     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a7aef02d95b80bfd627dc12f50759a925">lexer</a> = lexer;
<a name="l00329"></a>00329     <span class="keywordflow">if</span> (! <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a4832bad8845a35fc50f7a160901854a1">NIL_P</a>(lexmid))
<a name="l00330"></a>00330         v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#aa3a6893a27caaa73df527d9b3a387e79">lexmid</a> = <a class="code" href="../../dc/d0c/cparse_8c.html#afdaacbe000e5d054bf114a77e08248a9">value_to_id</a>(lexmid);
<a name="l00331"></a>00331 
<a name="l00332"></a>00332     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a1f5ed6eb5c79dc3282a92f54e918b7b6">debug</a> = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a117741045763c090b26e30a85bd0e0a6">RTEST</a>(<a class="code" href="../../db/d2e/intern_8h.html#a35a10b958666c1b330238eea7b7f3a8a">rb_ivar_get</a>(parser, <a class="code" href="../../dc/d0c/cparse_8c.html#af4d1e2269c213f3cff294b1a19cd8733">id_yydebug</a>));
<a name="l00333"></a>00333 
<a name="l00334"></a>00334     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#ad5a1e03b0a66824f95f6aaf07b4a4052">Check_Type</a>(arg, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#abbd332f6f94d77e0a369c7720128639e">T_ARRAY</a>);
<a name="l00335"></a>00335     <span class="keywordflow">if</span> (!(13 &lt;= <a class="code" href="../../d8/df4/generator_8h.html#ae988773ed219452578f881fc7189c486">RARRAY_LEN</a>(arg) &amp;&amp; <a class="code" href="../../d8/df4/generator_8h.html#ae988773ed219452578f881fc7189c486">RARRAY_LEN</a>(arg) &lt;= 14))
<a name="l00336"></a>00336         <a class="code" href="../../db/dcc/error_8c.html#a0f771a2840561f1838169b3d7d4616f3">rb_raise</a>(<a class="code" href="../../dc/d0c/cparse_8c.html#a384ab0d8c22f55bff306d4357d7b0482">RaccBug</a>, <span class="stringliteral">&quot;[Racc Bug] wrong arg.size %ld&quot;</span>, <a class="code" href="../../d8/df4/generator_8h.html#ae988773ed219452578f881fc7189c486">RARRAY_LEN</a>(arg));
<a name="l00337"></a>00337     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a56dc44b5d45a58967b1f21372577c7cf">action_table</a>   = <a class="code" href="../../dc/d0c/cparse_8c.html#ad42d6b1672bcfabadccf70ead72e25df">assert_array</a>  (<a class="code" href="../../d8/df4/generator_8h.html#abb794fe2d7c73eea87e7ba2273939a8e">RARRAY_PTR</a>(arg)[ 0]);
<a name="l00338"></a>00338     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a861d013af789f4528c0e287927a3a4a0">action_check</a>   = <a class="code" href="../../dc/d0c/cparse_8c.html#ad42d6b1672bcfabadccf70ead72e25df">assert_array</a>  (<a class="code" href="../../d8/df4/generator_8h.html#abb794fe2d7c73eea87e7ba2273939a8e">RARRAY_PTR</a>(arg)[ 1]);
<a name="l00339"></a>00339     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a68e1ae6cb0cc334bd4e91779b4e774a2">action_default</a> = <a class="code" href="../../dc/d0c/cparse_8c.html#ad42d6b1672bcfabadccf70ead72e25df">assert_array</a>  (<a class="code" href="../../d8/df4/generator_8h.html#abb794fe2d7c73eea87e7ba2273939a8e">RARRAY_PTR</a>(arg)[ 2]);
<a name="l00340"></a>00340     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a665885b75e904b3aa99820b0bb1e5e0d">action_pointer</a> = <a class="code" href="../../dc/d0c/cparse_8c.html#ad42d6b1672bcfabadccf70ead72e25df">assert_array</a>  (<a class="code" href="../../d8/df4/generator_8h.html#abb794fe2d7c73eea87e7ba2273939a8e">RARRAY_PTR</a>(arg)[ 3]);
<a name="l00341"></a>00341     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#aebb4301cbc7097fef44beb85c87028f5">goto_table</a>     = <a class="code" href="../../dc/d0c/cparse_8c.html#ad42d6b1672bcfabadccf70ead72e25df">assert_array</a>  (<a class="code" href="../../d8/df4/generator_8h.html#abb794fe2d7c73eea87e7ba2273939a8e">RARRAY_PTR</a>(arg)[ 4]);
<a name="l00342"></a>00342     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a85a7c77cae6772f8fbf3058404511f50">goto_check</a>     = <a class="code" href="../../dc/d0c/cparse_8c.html#ad42d6b1672bcfabadccf70ead72e25df">assert_array</a>  (<a class="code" href="../../d8/df4/generator_8h.html#abb794fe2d7c73eea87e7ba2273939a8e">RARRAY_PTR</a>(arg)[ 5]);
<a name="l00343"></a>00343     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a7fe1eb04943a6ca4a031ccc20b6fb444">goto_default</a>   = <a class="code" href="../../dc/d0c/cparse_8c.html#ad42d6b1672bcfabadccf70ead72e25df">assert_array</a>  (<a class="code" href="../../d8/df4/generator_8h.html#abb794fe2d7c73eea87e7ba2273939a8e">RARRAY_PTR</a>(arg)[ 6]);
<a name="l00344"></a>00344     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#abf10f0546f4fd80796daaf4305cfa620">goto_pointer</a>   = <a class="code" href="../../dc/d0c/cparse_8c.html#ad42d6b1672bcfabadccf70ead72e25df">assert_array</a>  (<a class="code" href="../../d8/df4/generator_8h.html#abb794fe2d7c73eea87e7ba2273939a8e">RARRAY_PTR</a>(arg)[ 7]);
<a name="l00345"></a>00345     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a90e41fcba354aaec8301f0e22ed4b5e6">nt_base</a>        = <a class="code" href="../../dc/d0c/cparse_8c.html#a24fbcb71b2b677086150d6eb1c00b691">assert_integer</a>(<a class="code" href="../../d8/df4/generator_8h.html#abb794fe2d7c73eea87e7ba2273939a8e">RARRAY_PTR</a>(arg)[ 8]);
<a name="l00346"></a>00346     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a86095a9b0442d4e61657877faa62771e">reduce_table</a>   = <a class="code" href="../../dc/d0c/cparse_8c.html#ad42d6b1672bcfabadccf70ead72e25df">assert_array</a>  (<a class="code" href="../../d8/df4/generator_8h.html#abb794fe2d7c73eea87e7ba2273939a8e">RARRAY_PTR</a>(arg)[ 9]);
<a name="l00347"></a>00347     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a4c2ca44a98a76de960f132c83ae1ec0c">token_table</a>    = <a class="code" href="../../dc/d0c/cparse_8c.html#af0e54309073a0856e18157fd1b21fc73">assert_hash</a>   (<a class="code" href="../../d8/df4/generator_8h.html#abb794fe2d7c73eea87e7ba2273939a8e">RARRAY_PTR</a>(arg)[10]);
<a name="l00348"></a>00348     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a179990d4dca0745db768fbe9ed43534a">shift_n</a>        = <a class="code" href="../../dc/d0c/cparse_8c.html#a24fbcb71b2b677086150d6eb1c00b691">assert_integer</a>(<a class="code" href="../../d8/df4/generator_8h.html#abb794fe2d7c73eea87e7ba2273939a8e">RARRAY_PTR</a>(arg)[11]);
<a name="l00349"></a>00349     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#aad3974d836e4912e7d0d4dfc38dd3ad9">reduce_n</a>       = <a class="code" href="../../dc/d0c/cparse_8c.html#a24fbcb71b2b677086150d6eb1c00b691">assert_integer</a>(<a class="code" href="../../d8/df4/generator_8h.html#abb794fe2d7c73eea87e7ba2273939a8e">RARRAY_PTR</a>(arg)[12]);
<a name="l00350"></a>00350     <span class="keywordflow">if</span> (<a class="code" href="../../d8/df4/generator_8h.html#ae988773ed219452578f881fc7189c486">RARRAY_LEN</a>(arg) &gt; 13) {
<a name="l00351"></a>00351         v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a37f41f8efcc1db46af71045593d630e9">use_result_var</a> = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a117741045763c090b26e30a85bd0e0a6">RTEST</a>(<a class="code" href="../../d8/df4/generator_8h.html#abb794fe2d7c73eea87e7ba2273939a8e">RARRAY_PTR</a>(arg)[13]);
<a name="l00352"></a>00352     }
<a name="l00353"></a>00353     <span class="keywordflow">else</span> {
<a name="l00354"></a>00354         v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a37f41f8efcc1db46af71045593d630e9">use_result_var</a> = <a class="code" href="../../d1/d5c/nkf_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00355"></a>00355     }
<a name="l00356"></a>00356 
<a name="l00357"></a>00357     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a057b5bc3450b324219ca9694e1d03907">tstack</a> = v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a1f5ed6eb5c79dc3282a92f54e918b7b6">debug</a> ? <a class="code" href="../../dc/d0c/cparse_8c.html#aaf0431a8462339e8b77f5d99df92f4ef">NEW_STACK</a>() : <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a320970f989dc8294c8203154e3db40c1">Qnil</a>;
<a name="l00358"></a>00358     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a8439f142d455ec7f89dcfc529474fc98">vstack</a> = <a class="code" href="../../dc/d0c/cparse_8c.html#aaf0431a8462339e8b77f5d99df92f4ef">NEW_STACK</a>();
<a name="l00359"></a>00359     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a23011040bbcce8a521e1edd97e7f8d36">state</a> = <a class="code" href="../../dc/d0c/cparse_8c.html#aaf0431a8462339e8b77f5d99df92f4ef">NEW_STACK</a>();
<a name="l00360"></a>00360     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a470e16b3d782757846c3481ddcf87e80">curstate</a> = 0;
<a name="l00361"></a>00361     <a class="code" href="../../de/d07/bigdecimal_8c.html#a070409486cc2c3c246d56a4c0db26185">PUSH</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a23011040bbcce8a521e1edd97e7f8d36">state</a>, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#ac55fae7f748afd3fc2533d0d7d06cf5a">INT2FIX</a>(0));
<a name="l00362"></a>00362     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ab04916133be3d87a36cd5d76531e61e9">t</a> = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#ac55fae7f748afd3fc2533d0d7d06cf5a">INT2FIX</a>(<a class="code" href="../../dc/d0c/cparse_8c.html#aba2daa828eb0fd6b23b435586a3009e8">FINAL_TOKEN</a> + 1);   <span class="comment">/* must not init to FINAL_TOKEN */</span>
<a name="l00363"></a>00363     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a7d3e36ab7f30cdfb535f44d21a18c431">nerr</a> = 0;
<a name="l00364"></a>00364     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5f228c7ab6c975d5d02bb7f227276270">errstatus</a> = 0;
<a name="l00365"></a>00365     <a class="code" href="../../db/d2e/intern_8h.html#acee88ad0375c8a9080e2283db494d257">rb_ivar_set</a>(parser, <a class="code" href="../../dc/d0c/cparse_8c.html#a81ab42d71c85cea1f094aa863dec2712">id_errstatus</a>, <a class="code" href="../../dc/d0c/cparse_8c.html#af1afba1194a12547a1e65d92abf03b03">LONG2NUM</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5f228c7ab6c975d5d02bb7f227276270">errstatus</a>));
<a name="l00366"></a>00366 
<a name="l00367"></a>00367     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a3eae0e73549f7dd9a4c136b154b02f69">retval</a> = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a320970f989dc8294c8203154e3db40c1">Qnil</a>;
<a name="l00368"></a>00368     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a211b8fd07c366b3621db91530a2efc03">fin</a> = 0;
<a name="l00369"></a>00369 
<a name="l00370"></a>00370     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ae09bcbe9e4b9db85dda830263c97dec5">lex_is_iterator</a> = <a class="code" href="../../d1/d5c/nkf_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00371"></a>00371 
<a name="l00372"></a>00372     <a class="code" href="../../db/d2e/intern_8h.html#a7e5b0d4c40fecb26c1ac946f674a690e">rb_iv_set</a>(parser, <span class="stringliteral">&quot;@vstack&quot;</span>, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a8439f142d455ec7f89dcfc529474fc98">vstack</a>);
<a name="l00373"></a>00373     <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a1f5ed6eb5c79dc3282a92f54e918b7b6">debug</a>) {
<a name="l00374"></a>00374         <a class="code" href="../../db/d2e/intern_8h.html#a7e5b0d4c40fecb26c1ac946f674a690e">rb_iv_set</a>(parser, <span class="stringliteral">&quot;@tstack&quot;</span>, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a057b5bc3450b324219ca9694e1d03907">tstack</a>);
<a name="l00375"></a>00375     }
<a name="l00376"></a>00376     <span class="keywordflow">else</span> {
<a name="l00377"></a>00377         <a class="code" href="../../db/d2e/intern_8h.html#a7e5b0d4c40fecb26c1ac946f674a690e">rb_iv_set</a>(parser, <span class="stringliteral">&quot;@tstack&quot;</span>, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a320970f989dc8294c8203154e3db40c1">Qnil</a>);
<a name="l00378"></a>00378     }
<a name="l00379"></a>00379 
<a name="l00380"></a>00380     <span class="keywordflow">return</span> vparams;
<a name="l00381"></a>00381 }
<a name="l00382"></a>00382 
<a name="l00383"></a>00383 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00384"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a995defe6c4937c73497142fdaf9a186f">00384</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a995defe6c4937c73497142fdaf9a186f">cparse_params_mark</a>(<span class="keywordtype">void</span> *ptr)
<a name="l00385"></a>00385 {
<a name="l00386"></a>00386     <span class="keyword">struct </span><a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a> *v = (<span class="keyword">struct </span><a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a>*)ptr;
<a name="l00387"></a>00387 
<a name="l00388"></a>00388     <a class="code" href="../../d8/d16/gc_8c.html#a98250264e6adf4924cf2becf80122325">rb_gc_mark</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ad4d64fc8a91da49f8afbff12fbb872c5">value_v</a>);
<a name="l00389"></a>00389     <a class="code" href="../../d8/d16/gc_8c.html#a98250264e6adf4924cf2becf80122325">rb_gc_mark</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5ab1ad36b90babc760699b47da3403e1">parser</a>);
<a name="l00390"></a>00390     <a class="code" href="../../d8/d16/gc_8c.html#a98250264e6adf4924cf2becf80122325">rb_gc_mark</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a7aef02d95b80bfd627dc12f50759a925">lexer</a>);
<a name="l00391"></a>00391     <a class="code" href="../../d8/d16/gc_8c.html#a98250264e6adf4924cf2becf80122325">rb_gc_mark</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a56dc44b5d45a58967b1f21372577c7cf">action_table</a>);
<a name="l00392"></a>00392     <a class="code" href="../../d8/d16/gc_8c.html#a98250264e6adf4924cf2becf80122325">rb_gc_mark</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a861d013af789f4528c0e287927a3a4a0">action_check</a>);
<a name="l00393"></a>00393     <a class="code" href="../../d8/d16/gc_8c.html#a98250264e6adf4924cf2becf80122325">rb_gc_mark</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a68e1ae6cb0cc334bd4e91779b4e774a2">action_default</a>);
<a name="l00394"></a>00394     <a class="code" href="../../d8/d16/gc_8c.html#a98250264e6adf4924cf2becf80122325">rb_gc_mark</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a665885b75e904b3aa99820b0bb1e5e0d">action_pointer</a>);
<a name="l00395"></a>00395     <a class="code" href="../../d8/d16/gc_8c.html#a98250264e6adf4924cf2becf80122325">rb_gc_mark</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#aebb4301cbc7097fef44beb85c87028f5">goto_table</a>);
<a name="l00396"></a>00396     <a class="code" href="../../d8/d16/gc_8c.html#a98250264e6adf4924cf2becf80122325">rb_gc_mark</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a85a7c77cae6772f8fbf3058404511f50">goto_check</a>);
<a name="l00397"></a>00397     <a class="code" href="../../d8/d16/gc_8c.html#a98250264e6adf4924cf2becf80122325">rb_gc_mark</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a7fe1eb04943a6ca4a031ccc20b6fb444">goto_default</a>);
<a name="l00398"></a>00398     <a class="code" href="../../d8/d16/gc_8c.html#a98250264e6adf4924cf2becf80122325">rb_gc_mark</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#abf10f0546f4fd80796daaf4305cfa620">goto_pointer</a>);
<a name="l00399"></a>00399     <a class="code" href="../../d8/d16/gc_8c.html#a98250264e6adf4924cf2becf80122325">rb_gc_mark</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a86095a9b0442d4e61657877faa62771e">reduce_table</a>);
<a name="l00400"></a>00400     <a class="code" href="../../d8/d16/gc_8c.html#a98250264e6adf4924cf2becf80122325">rb_gc_mark</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a4c2ca44a98a76de960f132c83ae1ec0c">token_table</a>);
<a name="l00401"></a>00401     <a class="code" href="../../d8/d16/gc_8c.html#a98250264e6adf4924cf2becf80122325">rb_gc_mark</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a23011040bbcce8a521e1edd97e7f8d36">state</a>);
<a name="l00402"></a>00402     <a class="code" href="../../d8/d16/gc_8c.html#a98250264e6adf4924cf2becf80122325">rb_gc_mark</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a8439f142d455ec7f89dcfc529474fc98">vstack</a>);
<a name="l00403"></a>00403     <a class="code" href="../../d8/d16/gc_8c.html#a98250264e6adf4924cf2becf80122325">rb_gc_mark</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a057b5bc3450b324219ca9694e1d03907">tstack</a>);
<a name="l00404"></a>00404     <a class="code" href="../../d8/d16/gc_8c.html#a98250264e6adf4924cf2becf80122325">rb_gc_mark</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ab04916133be3d87a36cd5d76531e61e9">t</a>);
<a name="l00405"></a>00405     <a class="code" href="../../d8/d16/gc_8c.html#a98250264e6adf4924cf2becf80122325">rb_gc_mark</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a3eae0e73549f7dd9a4c136b154b02f69">retval</a>);
<a name="l00406"></a>00406 }
<a name="l00407"></a>00407 
<a name="l00408"></a>00408 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00409"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a0d7724e1af9cfd9a9120ea10d4227778">00409</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a0d7724e1af9cfd9a9120ea10d4227778">extract_user_token</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a> *v, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> block_args,
<a name="l00410"></a>00410                    <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> *<a class="code" href="../../d5/d11/ripper_8c.html#a2b3a335d617ec14d6296ca82d3055858">tok</a>, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> *val)
<a name="l00411"></a>00411 {
<a name="l00412"></a>00412     <span class="keywordflow">if</span> (<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a4832bad8845a35fc50f7a160901854a1">NIL_P</a>(block_args)) {
<a name="l00413"></a>00413         <span class="comment">/* EOF */</span>
<a name="l00414"></a>00414         *tok = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#aba0717d2689eb68797421a02ab9295c6">Qfalse</a>;
<a name="l00415"></a>00415         *val = <a class="code" href="../../db/d2e/intern_8h.html#a48b2b873adb8b6a04254bd631c4b03c5">rb_str_new</a>(<span class="stringliteral">&quot;$&quot;</span>, 1);
<a name="l00416"></a>00416         <span class="keywordflow">return</span>;
<a name="l00417"></a>00417     }
<a name="l00418"></a>00418 
<a name="l00419"></a>00419     <span class="keywordflow">if</span> (<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a394faf7191f18552a20cb17ce14226f0">TYPE</a>(block_args) != <a class="code" href="../../de/de6/ruby_2ruby_8h.html#abbd332f6f94d77e0a369c7720128639e">T_ARRAY</a>) {
<a name="l00420"></a>00420         <a class="code" href="../../db/dcc/error_8c.html#a0f771a2840561f1838169b3d7d4616f3">rb_raise</a>(<a class="code" href="../../db/dcc/error_8c.html#a565ed9d70f4089e1b4a36e9b3381b8c6">rb_eTypeError</a>,
<a name="l00421"></a>00421                  <span class="stringliteral">&quot;%s() %s %s (must be Array[2])&quot;</span>,
<a name="l00422"></a>00422                  v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ae09bcbe9e4b9db85dda830263c97dec5">lex_is_iterator</a> ? <a class="code" href="../../d5/d11/ripper_8c.html#a877bc58c495643fcf49dc64c44631e72">rb_id2name</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#aa3a6893a27caaa73df527d9b3a387e79">lexmid</a>) : <span class="stringliteral">&quot;next_token&quot;</span>,
<a name="l00423"></a>00423                  v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ae09bcbe9e4b9db85dda830263c97dec5">lex_is_iterator</a> ? <span class="stringliteral">&quot;yielded&quot;</span> : <span class="stringliteral">&quot;returned&quot;</span>,
<a name="l00424"></a>00424                  <a class="code" href="../../de/de6/ruby_2ruby_8h.html#afd98e957d0d96017f7a07dd83772fadc">rb_class2name</a>(<a class="code" href="../../de/de6/ruby_2ruby_8h.html#ad07df58de9895cbc33c10f02540d2d4d">CLASS_OF</a>(block_args)));
<a name="l00425"></a>00425     }
<a name="l00426"></a>00426     <span class="keywordflow">if</span> (<a class="code" href="../../d8/df4/generator_8h.html#ae988773ed219452578f881fc7189c486">RARRAY_LEN</a>(block_args) != 2) {
<a name="l00427"></a>00427         <a class="code" href="../../db/dcc/error_8c.html#a0f771a2840561f1838169b3d7d4616f3">rb_raise</a>(<a class="code" href="../../db/dcc/error_8c.html#ab5e2a9fec766c75176fbb262bfe6a596">rb_eArgError</a>,
<a name="l00428"></a>00428                  <span class="stringliteral">&quot;%s() %s wrong size of array (%ld for 2)&quot;</span>,
<a name="l00429"></a>00429                  v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ae09bcbe9e4b9db85dda830263c97dec5">lex_is_iterator</a> ? <a class="code" href="../../d5/d11/ripper_8c.html#a877bc58c495643fcf49dc64c44631e72">rb_id2name</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#aa3a6893a27caaa73df527d9b3a387e79">lexmid</a>) : <span class="stringliteral">&quot;next_token&quot;</span>,
<a name="l00430"></a>00430                  v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ae09bcbe9e4b9db85dda830263c97dec5">lex_is_iterator</a> ? <span class="stringliteral">&quot;yielded&quot;</span> : <span class="stringliteral">&quot;returned&quot;</span>,
<a name="l00431"></a>00431                  <a class="code" href="../../d8/df4/generator_8h.html#ae988773ed219452578f881fc7189c486">RARRAY_LEN</a>(block_args));
<a name="l00432"></a>00432     }
<a name="l00433"></a>00433     *tok = <a class="code" href="../../dc/d0c/cparse_8c.html#a2c5302305d878024276c413652549eb9">AREF</a>(block_args, 0);
<a name="l00434"></a>00434     *val = <a class="code" href="../../dc/d0c/cparse_8c.html#a2c5302305d878024276c413652549eb9">AREF</a>(block_args, 1);
<a name="l00435"></a>00435 }
<a name="l00436"></a>00436 
<a name="l00437"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a2be46b178846e49bd56899440607814a">00437</a> <span class="preprocessor">#define SHIFT(v,act,tok,val) shift(v,act,tok,val)</span>
<a name="l00438"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a94f2fcc03ff91d48661d15c3a782004f">00438</a> <span class="preprocessor"></span><span class="preprocessor">#define REDUCE(v,act) do {\</span>
<a name="l00439"></a>00439 <span class="preprocessor">    switch (reduce(v,act)) {  \</span>
<a name="l00440"></a>00440 <span class="preprocessor">      case 0: </span><span class="comment">/* normal */</span>    \
<a name="l00441"></a>00441         break;                \
<a name="l00442"></a>00442       case 1: <span class="comment">/* yyerror */</span>   \
<a name="l00443"></a>00443         goto user_yyerror;    \
<a name="l00444"></a>00444       case 2: <span class="comment">/* yyaccept */</span>  \
<a name="l00445"></a>00445         D_puts(&quot;u accept&quot;);   \
<a name="l00446"></a>00446         goto accept;          \
<a name="l00447"></a>00447       default:                \
<a name="l00448"></a>00448         break;                \
<a name="l00449"></a>00449     }                         \
<a name="l00450"></a>00450 } while (0)
<a name="l00451"></a>00451 
<a name="l00452"></a>00452 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00453"></a><a class="code" href="../../dc/d0c/cparse_8c.html#aa31d084b704687b81f44c762bf358b30">00453</a> <a class="code" href="../../dc/d0c/cparse_8c.html#aa31d084b704687b81f44c762bf358b30">parse_main</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a> *v, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d5/d11/ripper_8c.html#a2b3a335d617ec14d6296ca82d3055858">tok</a>, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> val, <span class="keywordtype">int</span> resume)
<a name="l00454"></a>00454 {
<a name="l00455"></a>00455     <span class="keywordtype">long</span> <a class="code" href="../../d2/d6a/structcparse__params.html#ade9d6b574497062464b543e71a5424e0">i</a>;              <span class="comment">/* table index */</span>
<a name="l00456"></a>00456     <span class="keywordtype">long</span> act;            <span class="comment">/* action type */</span>
<a name="l00457"></a>00457     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> act_value;     <span class="comment">/* action type, VALUE version */</span>
<a name="l00458"></a>00458     <span class="keywordtype">int</span> read_next = 1;   <span class="comment">/* true if we need to read next token */</span>
<a name="l00459"></a>00459     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> tmp;
<a name="l00460"></a>00460 
<a name="l00461"></a>00461     <span class="keywordflow">if</span> (resume)
<a name="l00462"></a>00462         <span class="keywordflow">goto</span> resume;
<a name="l00463"></a>00463 
<a name="l00464"></a>00464     <span class="keywordflow">while</span> (1) {
<a name="l00465"></a>00465         <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00466"></a>00466         <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;---- enter new loop ----&quot;</span>);
<a name="l00467"></a>00467         <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00468"></a>00468 
<a name="l00469"></a>00469         <a class="code" href="../../dc/d0c/cparse_8c.html#a999aa703b22abcfb932f3baaeaec0f4a">D_printf</a>(<span class="stringliteral">&quot;(act) k1=%ld\n&quot;</span>, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a470e16b3d782757846c3481ddcf87e80">curstate</a>);
<a name="l00470"></a>00470         tmp = <a class="code" href="../../dc/d0c/cparse_8c.html#a2c5302305d878024276c413652549eb9">AREF</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a665885b75e904b3aa99820b0bb1e5e0d">action_pointer</a>, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a470e16b3d782757846c3481ddcf87e80">curstate</a>);
<a name="l00471"></a>00471         <span class="keywordflow">if</span> (<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a4832bad8845a35fc50f7a160901854a1">NIL_P</a>(tmp)) <span class="keywordflow">goto</span> notfound;
<a name="l00472"></a>00472         <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;(act) pointer[k1] ok&quot;</span>);
<a name="l00473"></a>00473         i = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a93f154f3dcc08027f475bf0c3cc287bd">NUM2LONG</a>(tmp);
<a name="l00474"></a>00474 
<a name="l00475"></a>00475         <a class="code" href="../../dc/d0c/cparse_8c.html#a999aa703b22abcfb932f3baaeaec0f4a">D_printf</a>(<span class="stringliteral">&quot;read_next=%d\n&quot;</span>, read_next);
<a name="l00476"></a>00476         <span class="keywordflow">if</span> (read_next &amp;&amp; (v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ab04916133be3d87a36cd5d76531e61e9">t</a> != <a class="code" href="../../dc/d0c/cparse_8c.html#a5e50338806ed51c0cc84823ac4b8315e">vFINAL_TOKEN</a>)) {
<a name="l00477"></a>00477             <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ae09bcbe9e4b9db85dda830263c97dec5">lex_is_iterator</a>) {
<a name="l00478"></a>00478                 <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;resuming...&quot;</span>);
<a name="l00479"></a>00479                 <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a211b8fd07c366b3621db91530a2efc03">fin</a>) <a class="code" href="../../db/dcc/error_8c.html#a0f771a2840561f1838169b3d7d4616f3">rb_raise</a>(<a class="code" href="../../db/dcc/error_8c.html#ab5e2a9fec766c75176fbb262bfe6a596">rb_eArgError</a>, <span class="stringliteral">&quot;token given after EOF&quot;</span>);
<a name="l00480"></a>00480                 v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ade9d6b574497062464b543e71a5424e0">i</a> = i;  <span class="comment">/* save i */</span>
<a name="l00481"></a>00481                 <span class="keywordflow">return</span>;
<a name="l00482"></a>00482               resume:
<a name="l00483"></a>00483                 <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;resumed&quot;</span>);
<a name="l00484"></a>00484                 i = v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ade9d6b574497062464b543e71a5424e0">i</a>;  <span class="comment">/* load i */</span>
<a name="l00485"></a>00485             }
<a name="l00486"></a>00486             <span class="keywordflow">else</span> {
<a name="l00487"></a>00487                 <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;next_token&quot;</span>);
<a name="l00488"></a>00488                 tmp = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a6a973fe624aa9aa9ba0cdeb6792d3187" title="Calls a method.">rb_funcall</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5ab1ad36b90babc760699b47da3403e1">parser</a>, <a class="code" href="../../dc/d0c/cparse_8c.html#a834be3eb5e540250a42734d7f4add8c2">id_nexttoken</a>, 0);
<a name="l00489"></a>00489                 <a class="code" href="../../dc/d0c/cparse_8c.html#a0d7724e1af9cfd9a9120ea10d4227778">extract_user_token</a>(v, tmp, &amp;tok, &amp;val);
<a name="l00490"></a>00490             }
<a name="l00491"></a>00491             <span class="comment">/* convert token */</span>
<a name="l00492"></a>00492             v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ab04916133be3d87a36cd5d76531e61e9">t</a> = <a class="code" href="../../d1/d04/hash_8c.html#ab7063832c7ed02351e87922a78e35c32">rb_hash_aref</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a4c2ca44a98a76de960f132c83ae1ec0c">token_table</a>, tok);
<a name="l00493"></a>00493             <span class="keywordflow">if</span> (<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a4832bad8845a35fc50f7a160901854a1">NIL_P</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ab04916133be3d87a36cd5d76531e61e9">t</a>)) {
<a name="l00494"></a>00494                 v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ab04916133be3d87a36cd5d76531e61e9">t</a> = <a class="code" href="../../dc/d0c/cparse_8c.html#adad73d4f4cbfbd263cc4049f9cb91e7f">vERROR_TOKEN</a>;
<a name="l00495"></a>00495             }
<a name="l00496"></a>00496             <a class="code" href="../../dc/d0c/cparse_8c.html#a999aa703b22abcfb932f3baaeaec0f4a">D_printf</a>(<span class="stringliteral">&quot;(act) t(k2)=%ld\n&quot;</span>, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a93f154f3dcc08027f475bf0c3cc287bd">NUM2LONG</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ab04916133be3d87a36cd5d76531e61e9">t</a>));
<a name="l00497"></a>00497             <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a1f5ed6eb5c79dc3282a92f54e918b7b6">debug</a>) {
<a name="l00498"></a>00498                 <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a6a973fe624aa9aa9ba0cdeb6792d3187" title="Calls a method.">rb_funcall</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5ab1ad36b90babc760699b47da3403e1">parser</a>, <a class="code" href="../../dc/d0c/cparse_8c.html#a8a92a5a5a571730aefae6ac864ff80cf">id_d_read_token</a>,
<a name="l00499"></a>00499                            3, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ab04916133be3d87a36cd5d76531e61e9">t</a>, tok, val);
<a name="l00500"></a>00500             }
<a name="l00501"></a>00501         }
<a name="l00502"></a>00502         read_next = 0;
<a name="l00503"></a>00503 
<a name="l00504"></a>00504         i += <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a93f154f3dcc08027f475bf0c3cc287bd">NUM2LONG</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ab04916133be3d87a36cd5d76531e61e9">t</a>);
<a name="l00505"></a>00505         <a class="code" href="../../dc/d0c/cparse_8c.html#a999aa703b22abcfb932f3baaeaec0f4a">D_printf</a>(<span class="stringliteral">&quot;(act) i=%ld\n&quot;</span>, i);
<a name="l00506"></a>00506         <span class="keywordflow">if</span> (i &lt; 0) <span class="keywordflow">goto</span> notfound;
<a name="l00507"></a>00507 
<a name="l00508"></a>00508         act_value = <a class="code" href="../../dc/d0c/cparse_8c.html#a2c5302305d878024276c413652549eb9">AREF</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a56dc44b5d45a58967b1f21372577c7cf">action_table</a>, i);
<a name="l00509"></a>00509         <span class="keywordflow">if</span> (<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a4832bad8845a35fc50f7a160901854a1">NIL_P</a>(act_value)) <span class="keywordflow">goto</span> notfound;
<a name="l00510"></a>00510         act = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a93f154f3dcc08027f475bf0c3cc287bd">NUM2LONG</a>(act_value);
<a name="l00511"></a>00511         <a class="code" href="../../dc/d0c/cparse_8c.html#a999aa703b22abcfb932f3baaeaec0f4a">D_printf</a>(<span class="stringliteral">&quot;(act) table[i]=%ld\n&quot;</span>, act);
<a name="l00512"></a>00512 
<a name="l00513"></a>00513         tmp = <a class="code" href="../../dc/d0c/cparse_8c.html#a2c5302305d878024276c413652549eb9">AREF</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a861d013af789f4528c0e287927a3a4a0">action_check</a>, i);
<a name="l00514"></a>00514         <span class="keywordflow">if</span> (<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a4832bad8845a35fc50f7a160901854a1">NIL_P</a>(tmp)) <span class="keywordflow">goto</span> notfound;
<a name="l00515"></a>00515         <span class="keywordflow">if</span> (<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a93f154f3dcc08027f475bf0c3cc287bd">NUM2LONG</a>(tmp) != v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a470e16b3d782757846c3481ddcf87e80">curstate</a>) <span class="keywordflow">goto</span> notfound;
<a name="l00516"></a>00516         <a class="code" href="../../dc/d0c/cparse_8c.html#a999aa703b22abcfb932f3baaeaec0f4a">D_printf</a>(<span class="stringliteral">&quot;(act) check[i]=%ld\n&quot;</span>, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a93f154f3dcc08027f475bf0c3cc287bd">NUM2LONG</a>(tmp));
<a name="l00517"></a>00517 
<a name="l00518"></a>00518         <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;(act) found&quot;</span>);
<a name="l00519"></a>00519       act_fixed:
<a name="l00520"></a>00520         <a class="code" href="../../dc/d0c/cparse_8c.html#a999aa703b22abcfb932f3baaeaec0f4a">D_printf</a>(<span class="stringliteral">&quot;act=%ld\n&quot;</span>, act);
<a name="l00521"></a>00521         <span class="keywordflow">goto</span> handle_act;
<a name="l00522"></a>00522 
<a name="l00523"></a>00523       notfound:
<a name="l00524"></a>00524         <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;(act) not found: use default&quot;</span>);
<a name="l00525"></a>00525         act_value = <a class="code" href="../../dc/d0c/cparse_8c.html#a2c5302305d878024276c413652549eb9">AREF</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a68e1ae6cb0cc334bd4e91779b4e774a2">action_default</a>, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a470e16b3d782757846c3481ddcf87e80">curstate</a>);
<a name="l00526"></a>00526         act = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a93f154f3dcc08027f475bf0c3cc287bd">NUM2LONG</a>(act_value);
<a name="l00527"></a>00527         <span class="keywordflow">goto</span> act_fixed;
<a name="l00528"></a>00528 
<a name="l00529"></a>00529 
<a name="l00530"></a>00530       handle_act:
<a name="l00531"></a>00531         <span class="keywordflow">if</span> (act &gt; 0 &amp;&amp; act &lt; v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a179990d4dca0745db768fbe9ed43534a">shift_n</a>) {
<a name="l00532"></a>00532             <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;shift&quot;</span>);
<a name="l00533"></a>00533             <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5f228c7ab6c975d5d02bb7f227276270">errstatus</a> &gt; 0) {
<a name="l00534"></a>00534                 v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5f228c7ab6c975d5d02bb7f227276270">errstatus</a>--;
<a name="l00535"></a>00535                 <a class="code" href="../../db/d2e/intern_8h.html#acee88ad0375c8a9080e2283db494d257">rb_ivar_set</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5ab1ad36b90babc760699b47da3403e1">parser</a>, <a class="code" href="../../dc/d0c/cparse_8c.html#a81ab42d71c85cea1f094aa863dec2712">id_errstatus</a>, <a class="code" href="../../dc/d0c/cparse_8c.html#af1afba1194a12547a1e65d92abf03b03">LONG2NUM</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5f228c7ab6c975d5d02bb7f227276270">errstatus</a>));
<a name="l00536"></a>00536             }
<a name="l00537"></a>00537             <a class="code" href="../../dc/d0c/cparse_8c.html#a2be46b178846e49bd56899440607814a">SHIFT</a>(v, act, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ab04916133be3d87a36cd5d76531e61e9">t</a>, val);
<a name="l00538"></a>00538             read_next = 1;
<a name="l00539"></a>00539         }
<a name="l00540"></a>00540         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (act &lt; 0 &amp;&amp; act &gt; -(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#aad3974d836e4912e7d0d4dfc38dd3ad9">reduce_n</a>)) {
<a name="l00541"></a>00541             <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;reduce&quot;</span>);
<a name="l00542"></a>00542             <a class="code" href="../../dc/d0c/cparse_8c.html#a94f2fcc03ff91d48661d15c3a782004f">REDUCE</a>(v, act);
<a name="l00543"></a>00543         }
<a name="l00544"></a>00544         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (act == -(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#aad3974d836e4912e7d0d4dfc38dd3ad9">reduce_n</a>)) {
<a name="l00545"></a>00545             <span class="keywordflow">goto</span> error;
<a name="l00546"></a>00546           error_recovered:
<a name="l00547"></a>00547             ;   <span class="comment">/* goto label requires stmt */</span>
<a name="l00548"></a>00548         }
<a name="l00549"></a>00549         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (act == v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a179990d4dca0745db768fbe9ed43534a">shift_n</a>) {
<a name="l00550"></a>00550             <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;accept&quot;</span>);
<a name="l00551"></a>00551             <span class="keywordflow">goto</span> accept;
<a name="l00552"></a>00552         }
<a name="l00553"></a>00553         <span class="keywordflow">else</span> {
<a name="l00554"></a>00554             <a class="code" href="../../db/dcc/error_8c.html#a0f771a2840561f1838169b3d7d4616f3">rb_raise</a>(<a class="code" href="../../dc/d0c/cparse_8c.html#a384ab0d8c22f55bff306d4357d7b0482">RaccBug</a>, <span class="stringliteral">&quot;[Racc Bug] unknown act value %ld&quot;</span>, act);
<a name="l00555"></a>00555         }
<a name="l00556"></a>00556 
<a name="l00557"></a>00557         <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a1f5ed6eb5c79dc3282a92f54e918b7b6">debug</a>) {
<a name="l00558"></a>00558             <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a6a973fe624aa9aa9ba0cdeb6792d3187" title="Calls a method.">rb_funcall</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5ab1ad36b90babc760699b47da3403e1">parser</a>, <a class="code" href="../../dc/d0c/cparse_8c.html#aeae35d86a3ea05fc3831156492e8427e">id_d_next_state</a>,
<a name="l00559"></a>00559                        2, <a class="code" href="../../dc/d0c/cparse_8c.html#af1afba1194a12547a1e65d92abf03b03">LONG2NUM</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a470e16b3d782757846c3481ddcf87e80">curstate</a>), v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a23011040bbcce8a521e1edd97e7f8d36">state</a>);
<a name="l00560"></a>00560         }
<a name="l00561"></a>00561     }
<a name="l00562"></a>00562     <span class="comment">/* not reach */</span>
<a name="l00563"></a>00563 
<a name="l00564"></a>00564 
<a name="l00565"></a>00565   accept:
<a name="l00566"></a>00566     <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a1f5ed6eb5c79dc3282a92f54e918b7b6">debug</a>) <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a6a973fe624aa9aa9ba0cdeb6792d3187" title="Calls a method.">rb_funcall</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5ab1ad36b90babc760699b47da3403e1">parser</a>, <a class="code" href="../../dc/d0c/cparse_8c.html#a83eb2a82ce7b62c5d197b3077750e034">id_d_accept</a>, 0);
<a name="l00567"></a>00567     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a3eae0e73549f7dd9a4c136b154b02f69">retval</a> = <a class="code" href="../../d8/df4/generator_8h.html#abb794fe2d7c73eea87e7ba2273939a8e">RARRAY_PTR</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a8439f142d455ec7f89dcfc529474fc98">vstack</a>)[0];
<a name="l00568"></a>00568     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a211b8fd07c366b3621db91530a2efc03">fin</a> = <a class="code" href="../../dc/d0c/cparse_8c.html#a05254fd484bcb6537b214490246237a1">CP_FIN_ACCEPT</a>;
<a name="l00569"></a>00569     <span class="keywordflow">return</span>;
<a name="l00570"></a>00570 
<a name="l00571"></a>00571 
<a name="l00572"></a>00572   error:
<a name="l00573"></a>00573     <a class="code" href="../../dc/d0c/cparse_8c.html#a999aa703b22abcfb932f3baaeaec0f4a">D_printf</a>(<span class="stringliteral">&quot;error detected, status=%ld\n&quot;</span>, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5f228c7ab6c975d5d02bb7f227276270">errstatus</a>);
<a name="l00574"></a>00574     <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5f228c7ab6c975d5d02bb7f227276270">errstatus</a> == 0) {
<a name="l00575"></a>00575         v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a7d3e36ab7f30cdfb535f44d21a18c431">nerr</a>++;
<a name="l00576"></a>00576         <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a6a973fe624aa9aa9ba0cdeb6792d3187" title="Calls a method.">rb_funcall</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5ab1ad36b90babc760699b47da3403e1">parser</a>, <a class="code" href="../../dc/d0c/cparse_8c.html#ab3cf40d11f0dca0181034720feb0a83d">id_onerror</a>,
<a name="l00577"></a>00577                    3, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ab04916133be3d87a36cd5d76531e61e9">t</a>, val, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a8439f142d455ec7f89dcfc529474fc98">vstack</a>);
<a name="l00578"></a>00578     }
<a name="l00579"></a>00579   user_yyerror:
<a name="l00580"></a>00580     <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5f228c7ab6c975d5d02bb7f227276270">errstatus</a> == 3) {
<a name="l00581"></a>00581         <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ab04916133be3d87a36cd5d76531e61e9">t</a> == <a class="code" href="../../dc/d0c/cparse_8c.html#a5e50338806ed51c0cc84823ac4b8315e">vFINAL_TOKEN</a>) {
<a name="l00582"></a>00582             v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a3eae0e73549f7dd9a4c136b154b02f69">retval</a> = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#aba0717d2689eb68797421a02ab9295c6">Qfalse</a>;
<a name="l00583"></a>00583             v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a211b8fd07c366b3621db91530a2efc03">fin</a> = <a class="code" href="../../dc/d0c/cparse_8c.html#ad45dfea4a0104d3d7b1e841e9894f48a">CP_FIN_EOT</a>;
<a name="l00584"></a>00584             <span class="keywordflow">return</span>;
<a name="l00585"></a>00585         }
<a name="l00586"></a>00586         read_next = 1;
<a name="l00587"></a>00587     }
<a name="l00588"></a>00588     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5f228c7ab6c975d5d02bb7f227276270">errstatus</a> = 3;
<a name="l00589"></a>00589     <a class="code" href="../../db/d2e/intern_8h.html#acee88ad0375c8a9080e2283db494d257">rb_ivar_set</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5ab1ad36b90babc760699b47da3403e1">parser</a>, <a class="code" href="../../dc/d0c/cparse_8c.html#a81ab42d71c85cea1f094aa863dec2712">id_errstatus</a>, <a class="code" href="../../dc/d0c/cparse_8c.html#af1afba1194a12547a1e65d92abf03b03">LONG2NUM</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5f228c7ab6c975d5d02bb7f227276270">errstatus</a>));
<a name="l00590"></a>00590 
<a name="l00591"></a>00591     <span class="comment">/* check if we can shift/reduce error token */</span>
<a name="l00592"></a>00592     <a class="code" href="../../dc/d0c/cparse_8c.html#a999aa703b22abcfb932f3baaeaec0f4a">D_printf</a>(<span class="stringliteral">&quot;(err) k1=%ld\n&quot;</span>, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a470e16b3d782757846c3481ddcf87e80">curstate</a>);
<a name="l00593"></a>00593     <a class="code" href="../../dc/d0c/cparse_8c.html#a999aa703b22abcfb932f3baaeaec0f4a">D_printf</a>(<span class="stringliteral">&quot;(err) k2=%d (error)\n&quot;</span>, <a class="code" href="../../dc/d0c/cparse_8c.html#a2983b695e827265a5b46ab9405446e36">ERROR_TOKEN</a>);
<a name="l00594"></a>00594     <span class="keywordflow">while</span> (1) {
<a name="l00595"></a>00595         tmp = <a class="code" href="../../dc/d0c/cparse_8c.html#a2c5302305d878024276c413652549eb9">AREF</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a665885b75e904b3aa99820b0bb1e5e0d">action_pointer</a>, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a470e16b3d782757846c3481ddcf87e80">curstate</a>);
<a name="l00596"></a>00596         <span class="keywordflow">if</span> (<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a4832bad8845a35fc50f7a160901854a1">NIL_P</a>(tmp)) <span class="keywordflow">goto</span> error_pop;
<a name="l00597"></a>00597         <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;(err) pointer[k1] ok&quot;</span>);
<a name="l00598"></a>00598 
<a name="l00599"></a>00599         i = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a93f154f3dcc08027f475bf0c3cc287bd">NUM2LONG</a>(tmp) + <a class="code" href="../../dc/d0c/cparse_8c.html#a2983b695e827265a5b46ab9405446e36">ERROR_TOKEN</a>;
<a name="l00600"></a>00600         <a class="code" href="../../dc/d0c/cparse_8c.html#a999aa703b22abcfb932f3baaeaec0f4a">D_printf</a>(<span class="stringliteral">&quot;(err) i=%ld\n&quot;</span>, i);
<a name="l00601"></a>00601         <span class="keywordflow">if</span> (i &lt; 0) <span class="keywordflow">goto</span> error_pop;
<a name="l00602"></a>00602 
<a name="l00603"></a>00603         act_value = <a class="code" href="../../dc/d0c/cparse_8c.html#a2c5302305d878024276c413652549eb9">AREF</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a56dc44b5d45a58967b1f21372577c7cf">action_table</a>, i);
<a name="l00604"></a>00604         <span class="keywordflow">if</span> (<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a4832bad8845a35fc50f7a160901854a1">NIL_P</a>(act_value)) {
<a name="l00605"></a>00605             <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;(err) table[i] == nil&quot;</span>);
<a name="l00606"></a>00606             <span class="keywordflow">goto</span> error_pop;
<a name="l00607"></a>00607         }
<a name="l00608"></a>00608         act = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a93f154f3dcc08027f475bf0c3cc287bd">NUM2LONG</a>(act_value);
<a name="l00609"></a>00609         <a class="code" href="../../dc/d0c/cparse_8c.html#a999aa703b22abcfb932f3baaeaec0f4a">D_printf</a>(<span class="stringliteral">&quot;(err) table[i]=%ld\n&quot;</span>, act);
<a name="l00610"></a>00610 
<a name="l00611"></a>00611         tmp = <a class="code" href="../../dc/d0c/cparse_8c.html#a2c5302305d878024276c413652549eb9">AREF</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a861d013af789f4528c0e287927a3a4a0">action_check</a>, i);
<a name="l00612"></a>00612         <span class="keywordflow">if</span> (<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a4832bad8845a35fc50f7a160901854a1">NIL_P</a>(tmp)) {
<a name="l00613"></a>00613             <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;(err) check[i] == nil&quot;</span>);
<a name="l00614"></a>00614             <span class="keywordflow">goto</span> error_pop;
<a name="l00615"></a>00615         }
<a name="l00616"></a>00616         <span class="keywordflow">if</span> (<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a93f154f3dcc08027f475bf0c3cc287bd">NUM2LONG</a>(tmp) != v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a470e16b3d782757846c3481ddcf87e80">curstate</a>) {
<a name="l00617"></a>00617             <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;(err) check[i] != k1&quot;</span>);
<a name="l00618"></a>00618             <span class="keywordflow">goto</span> error_pop;
<a name="l00619"></a>00619         }
<a name="l00620"></a>00620 
<a name="l00621"></a>00621         <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;(err) found: can handle error token&quot;</span>);
<a name="l00622"></a>00622         <span class="keywordflow">break</span>;
<a name="l00623"></a>00623 
<a name="l00624"></a>00624       error_pop:
<a name="l00625"></a>00625         <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;(err) act not found: can&apos;t handle error token; pop&quot;</span>);
<a name="l00626"></a>00626 
<a name="l00627"></a>00627         <span class="keywordflow">if</span> (<a class="code" href="../../d8/df4/generator_8h.html#ae988773ed219452578f881fc7189c486">RARRAY_LEN</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a23011040bbcce8a521e1edd97e7f8d36">state</a>) &lt;= 1) {
<a name="l00628"></a>00628             v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a3eae0e73549f7dd9a4c136b154b02f69">retval</a> = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a320970f989dc8294c8203154e3db40c1">Qnil</a>;
<a name="l00629"></a>00629             v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a211b8fd07c366b3621db91530a2efc03">fin</a> = <a class="code" href="../../dc/d0c/cparse_8c.html#a5ec0f7cece638b5a69b1c927f2b21965">CP_FIN_CANTPOP</a>;
<a name="l00630"></a>00630             <span class="keywordflow">return</span>;
<a name="l00631"></a>00631         }
<a name="l00632"></a>00632         <a class="code" href="../../dc/d0c/cparse_8c.html#ab430e768f7286ab406613648c5658eff">POP</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a23011040bbcce8a521e1edd97e7f8d36">state</a>);
<a name="l00633"></a>00633         <a class="code" href="../../dc/d0c/cparse_8c.html#ab430e768f7286ab406613648c5658eff">POP</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a8439f142d455ec7f89dcfc529474fc98">vstack</a>);
<a name="l00634"></a>00634         v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a470e16b3d782757846c3481ddcf87e80">curstate</a> = <a class="code" href="../../dc/d0c/cparse_8c.html#a1d29c991a29cc368e49bfa491533c9c2">num_to_long</a>(<a class="code" href="../../dc/d0c/cparse_8c.html#a1c3e8e57f54d4a4caf5cbfef9a85cb69">LAST_I</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a23011040bbcce8a521e1edd97e7f8d36">state</a>));
<a name="l00635"></a>00635         <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a1f5ed6eb5c79dc3282a92f54e918b7b6">debug</a>) {
<a name="l00636"></a>00636             <a class="code" href="../../dc/d0c/cparse_8c.html#ab430e768f7286ab406613648c5658eff">POP</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a057b5bc3450b324219ca9694e1d03907">tstack</a>);
<a name="l00637"></a>00637             <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a6a973fe624aa9aa9ba0cdeb6792d3187" title="Calls a method.">rb_funcall</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5ab1ad36b90babc760699b47da3403e1">parser</a>, <a class="code" href="../../dc/d0c/cparse_8c.html#a2de7e7e741e5e52a250760fd2e3f815a">id_d_e_pop</a>,
<a name="l00638"></a>00638                        3, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a23011040bbcce8a521e1edd97e7f8d36">state</a>, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a057b5bc3450b324219ca9694e1d03907">tstack</a>, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a8439f142d455ec7f89dcfc529474fc98">vstack</a>);
<a name="l00639"></a>00639         }
<a name="l00640"></a>00640     }
<a name="l00641"></a>00641 
<a name="l00642"></a>00642     <span class="comment">/* shift/reduce error token */</span>
<a name="l00643"></a>00643     <span class="keywordflow">if</span> (act &gt; 0 &amp;&amp; act &lt; v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a179990d4dca0745db768fbe9ed43534a">shift_n</a>) {
<a name="l00644"></a>00644         <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;e shift&quot;</span>);
<a name="l00645"></a>00645         <a class="code" href="../../dc/d0c/cparse_8c.html#a2be46b178846e49bd56899440607814a">SHIFT</a>(v, act, <a class="code" href="../../dc/d0c/cparse_8c.html#a2983b695e827265a5b46ab9405446e36">ERROR_TOKEN</a>, val);
<a name="l00646"></a>00646     }
<a name="l00647"></a>00647     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (act &lt; 0 &amp;&amp; act &gt; -(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#aad3974d836e4912e7d0d4dfc38dd3ad9">reduce_n</a>)) {
<a name="l00648"></a>00648         <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;e reduce&quot;</span>);
<a name="l00649"></a>00649         <a class="code" href="../../dc/d0c/cparse_8c.html#a94f2fcc03ff91d48661d15c3a782004f">REDUCE</a>(v, act);
<a name="l00650"></a>00650     }
<a name="l00651"></a>00651     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (act == v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a179990d4dca0745db768fbe9ed43534a">shift_n</a>) {
<a name="l00652"></a>00652         <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;e accept&quot;</span>);
<a name="l00653"></a>00653         <span class="keywordflow">goto</span> accept;
<a name="l00654"></a>00654     }
<a name="l00655"></a>00655     <span class="keywordflow">else</span> {
<a name="l00656"></a>00656         <a class="code" href="../../db/dcc/error_8c.html#a0f771a2840561f1838169b3d7d4616f3">rb_raise</a>(<a class="code" href="../../dc/d0c/cparse_8c.html#a384ab0d8c22f55bff306d4357d7b0482">RaccBug</a>, <span class="stringliteral">&quot;[Racc Bug] unknown act value %ld&quot;</span>, act);
<a name="l00657"></a>00657     }
<a name="l00658"></a>00658     <span class="keywordflow">goto</span> error_recovered;
<a name="l00659"></a>00659 }
<a name="l00660"></a>00660 
<a name="l00661"></a>00661 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00662"></a><a class="code" href="../../dc/d0c/cparse_8c.html#ae2e438d537892aeadba05c15eefbe89d">00662</a> <a class="code" href="../../dc/d0c/cparse_8c.html#ae2e438d537892aeadba05c15eefbe89d">shift</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a> *v, <span class="keywordtype">long</span> act, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <a class="code" href="../../d5/d11/ripper_8c.html#a2b3a335d617ec14d6296ca82d3055858">tok</a>, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> val)
<a name="l00663"></a>00663 {
<a name="l00664"></a>00664     <a class="code" href="../../de/d07/bigdecimal_8c.html#a070409486cc2c3c246d56a4c0db26185">PUSH</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a8439f142d455ec7f89dcfc529474fc98">vstack</a>, val);
<a name="l00665"></a>00665     <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a1f5ed6eb5c79dc3282a92f54e918b7b6">debug</a>) {
<a name="l00666"></a>00666         <a class="code" href="../../de/d07/bigdecimal_8c.html#a070409486cc2c3c246d56a4c0db26185">PUSH</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a057b5bc3450b324219ca9694e1d03907">tstack</a>, tok);
<a name="l00667"></a>00667         <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a6a973fe624aa9aa9ba0cdeb6792d3187" title="Calls a method.">rb_funcall</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5ab1ad36b90babc760699b47da3403e1">parser</a>, <a class="code" href="../../dc/d0c/cparse_8c.html#a23878f80efaea8fbf95436cdf58b84cd">id_d_shift</a>,
<a name="l00668"></a>00668                    3, tok, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a057b5bc3450b324219ca9694e1d03907">tstack</a>, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a8439f142d455ec7f89dcfc529474fc98">vstack</a>);
<a name="l00669"></a>00669     }
<a name="l00670"></a>00670     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a470e16b3d782757846c3481ddcf87e80">curstate</a> = act;
<a name="l00671"></a>00671     <a class="code" href="../../de/d07/bigdecimal_8c.html#a070409486cc2c3c246d56a4c0db26185">PUSH</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a23011040bbcce8a521e1edd97e7f8d36">state</a>, <a class="code" href="../../dc/d0c/cparse_8c.html#af1afba1194a12547a1e65d92abf03b03">LONG2NUM</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a470e16b3d782757846c3481ddcf87e80">curstate</a>));
<a name="l00672"></a>00672 }
<a name="l00673"></a>00673 
<a name="l00674"></a>00674 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00675"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a76d696c4b420b56a6694162a4f8eb38b">00675</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a76d696c4b420b56a6694162a4f8eb38b">reduce</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a> *v, <span class="keywordtype">long</span> act)
<a name="l00676"></a>00676 {
<a name="l00677"></a>00677     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> code;
<a name="l00678"></a>00678     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a223a9b75b69daefedddc3a26583020cb">ruleno</a> = -act * 3;
<a name="l00679"></a>00679     code = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a4efb0248655c4632827f1ecc108e0fa7">rb_catch</a>(<span class="stringliteral">&quot;racc_jump&quot;</span>, <a class="code" href="../../dc/d0c/cparse_8c.html#a5ed2883f827f6e9773e4692c9825156f">reduce0</a>, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#ad4d64fc8a91da49f8afbff12fbb872c5">value_v</a>);
<a name="l00680"></a>00680     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5f228c7ab6c975d5d02bb7f227276270">errstatus</a> = <a class="code" href="../../dc/d0c/cparse_8c.html#a1d29c991a29cc368e49bfa491533c9c2">num_to_long</a>(<a class="code" href="../../db/d2e/intern_8h.html#a35a10b958666c1b330238eea7b7f3a8a">rb_ivar_get</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5ab1ad36b90babc760699b47da3403e1">parser</a>, <a class="code" href="../../dc/d0c/cparse_8c.html#a81ab42d71c85cea1f094aa863dec2712">id_errstatus</a>));
<a name="l00681"></a>00681     <span class="keywordflow">return</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a877c38180d23c5447d976c70dda89d69">NUM2INT</a>(code);
<a name="l00682"></a>00682 }
<a name="l00683"></a>00683 
<a name="l00684"></a>00684 <span class="keyword">static</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a>
<a name="l00685"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a5ed2883f827f6e9773e4692c9825156f">00685</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a5ed2883f827f6e9773e4692c9825156f">reduce0</a>(<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> val, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> data, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> <span class="keyword">self</span>)
<a name="l00686"></a>00686 {
<a name="l00687"></a>00687     <span class="keyword">struct </span><a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a> *v;
<a name="l00688"></a>00688     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> reduce_to, reduce_len, method_id;
<a name="l00689"></a>00689     <span class="keywordtype">long</span> <a class="code" href="../../d3/d15/name2ctype_8h.html#aed1cc4dca5d94cb452f79691f54f7423">len</a>;
<a name="l00690"></a>00690     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#afa5b9137f051ac26d7ccc8824f178233">ID</a> mid;
<a name="l00691"></a>00691     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> tmp, tmp_t = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a2edf6990280eb2637623ccd421dee4f0">Qundef</a>, tmp_v = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a2edf6990280eb2637623ccd421dee4f0">Qundef</a>;
<a name="l00692"></a>00692     <span class="keywordtype">long</span> <a class="code" href="../../d2/d6a/structcparse__params.html#ade9d6b574497062464b543e71a5424e0">i</a>, k1, k2;
<a name="l00693"></a>00693     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> goto_state;
<a name="l00694"></a>00694 
<a name="l00695"></a>00695     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#ad043eb0996705571cad2e5bb39e9675e">Data_Get_Struct</a>(data, <span class="keyword">struct</span> <a class="code" href="../../d2/d6a/structcparse__params.html">cparse_params</a>, v);
<a name="l00696"></a>00696     reduce_len = <a class="code" href="../../d8/df4/generator_8h.html#abb794fe2d7c73eea87e7ba2273939a8e">RARRAY_PTR</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a86095a9b0442d4e61657877faa62771e">reduce_table</a>)[v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a223a9b75b69daefedddc3a26583020cb">ruleno</a>];
<a name="l00697"></a>00697     reduce_to  = <a class="code" href="../../d8/df4/generator_8h.html#abb794fe2d7c73eea87e7ba2273939a8e">RARRAY_PTR</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a86095a9b0442d4e61657877faa62771e">reduce_table</a>)[v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a223a9b75b69daefedddc3a26583020cb">ruleno</a>+1];
<a name="l00698"></a>00698     method_id  = <a class="code" href="../../d8/df4/generator_8h.html#abb794fe2d7c73eea87e7ba2273939a8e">RARRAY_PTR</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a86095a9b0442d4e61657877faa62771e">reduce_table</a>)[v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a223a9b75b69daefedddc3a26583020cb">ruleno</a>+2];
<a name="l00699"></a>00699     len = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a93f154f3dcc08027f475bf0c3cc287bd">NUM2LONG</a>(reduce_len);
<a name="l00700"></a>00700     mid = <a class="code" href="../../dc/d0c/cparse_8c.html#afdaacbe000e5d054bf114a77e08248a9">value_to_id</a>(method_id);
<a name="l00701"></a>00701 
<a name="l00702"></a>00702     <span class="comment">/* call action */</span>
<a name="l00703"></a>00703     <span class="keywordflow">if</span> (len == 0) {
<a name="l00704"></a>00704         tmp = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a320970f989dc8294c8203154e3db40c1">Qnil</a>;
<a name="l00705"></a>00705         <span class="keywordflow">if</span> (mid != <a class="code" href="../../dc/d0c/cparse_8c.html#a6800221fc9e6149fb97eeafc1e84947d">id_noreduce</a>)
<a name="l00706"></a>00706             tmp_v = <a class="code" href="../../dc/dcc/array_8c.html#a9518114fd36cb4ef4656ec1dc63348c9">rb_ary_new</a>();
<a name="l00707"></a>00707         <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a1f5ed6eb5c79dc3282a92f54e918b7b6">debug</a>)
<a name="l00708"></a>00708             tmp_t = <a class="code" href="../../dc/dcc/array_8c.html#a9518114fd36cb4ef4656ec1dc63348c9">rb_ary_new</a>();
<a name="l00709"></a>00709     }
<a name="l00710"></a>00710     <span class="keywordflow">else</span> {
<a name="l00711"></a>00711         <span class="keywordflow">if</span> (mid != <a class="code" href="../../dc/d0c/cparse_8c.html#a6800221fc9e6149fb97eeafc1e84947d">id_noreduce</a>) {
<a name="l00712"></a>00712             tmp_v = <a class="code" href="../../dc/d0c/cparse_8c.html#a603fc30adeeffc9ce15a749d92ec0f1f">GET_TAIL</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a8439f142d455ec7f89dcfc529474fc98">vstack</a>, len);
<a name="l00713"></a>00713             tmp = <a class="code" href="../../d8/df4/generator_8h.html#abb794fe2d7c73eea87e7ba2273939a8e">RARRAY_PTR</a>(tmp_v)[0];
<a name="l00714"></a>00714         }
<a name="l00715"></a>00715         <span class="keywordflow">else</span> {
<a name="l00716"></a>00716             tmp = <a class="code" href="../../d8/df4/generator_8h.html#abb794fe2d7c73eea87e7ba2273939a8e">RARRAY_PTR</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a8439f142d455ec7f89dcfc529474fc98">vstack</a>)[ <a class="code" href="../../d8/df4/generator_8h.html#ae988773ed219452578f881fc7189c486">RARRAY_LEN</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a8439f142d455ec7f89dcfc529474fc98">vstack</a>) - len ];
<a name="l00717"></a>00717         }
<a name="l00718"></a>00718         <a class="code" href="../../dc/d0c/cparse_8c.html#adff91c561f0dd974151974f9da684b63">CUT_TAIL</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a8439f142d455ec7f89dcfc529474fc98">vstack</a>, len);
<a name="l00719"></a>00719         <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a1f5ed6eb5c79dc3282a92f54e918b7b6">debug</a>) {
<a name="l00720"></a>00720             tmp_t = <a class="code" href="../../dc/d0c/cparse_8c.html#a603fc30adeeffc9ce15a749d92ec0f1f">GET_TAIL</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a057b5bc3450b324219ca9694e1d03907">tstack</a>, len);
<a name="l00721"></a>00721             <a class="code" href="../../dc/d0c/cparse_8c.html#adff91c561f0dd974151974f9da684b63">CUT_TAIL</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a057b5bc3450b324219ca9694e1d03907">tstack</a>, len);
<a name="l00722"></a>00722         }
<a name="l00723"></a>00723         <a class="code" href="../../dc/d0c/cparse_8c.html#adff91c561f0dd974151974f9da684b63">CUT_TAIL</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a23011040bbcce8a521e1edd97e7f8d36">state</a>, len);
<a name="l00724"></a>00724     }
<a name="l00725"></a>00725     <span class="keywordflow">if</span> (mid != <a class="code" href="../../dc/d0c/cparse_8c.html#a6800221fc9e6149fb97eeafc1e84947d">id_noreduce</a>) {
<a name="l00726"></a>00726         <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a37f41f8efcc1db46af71045593d630e9">use_result_var</a>) {
<a name="l00727"></a>00727             tmp = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a6a973fe624aa9aa9ba0cdeb6792d3187" title="Calls a method.">rb_funcall</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5ab1ad36b90babc760699b47da3403e1">parser</a>, mid,
<a name="l00728"></a>00728                              3, tmp_v, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a8439f142d455ec7f89dcfc529474fc98">vstack</a>, tmp);
<a name="l00729"></a>00729         }
<a name="l00730"></a>00730         <span class="keywordflow">else</span> {
<a name="l00731"></a>00731             tmp = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a6a973fe624aa9aa9ba0cdeb6792d3187" title="Calls a method.">rb_funcall</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5ab1ad36b90babc760699b47da3403e1">parser</a>, mid,
<a name="l00732"></a>00732                              2, tmp_v, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a8439f142d455ec7f89dcfc529474fc98">vstack</a>);
<a name="l00733"></a>00733         }
<a name="l00734"></a>00734     }
<a name="l00735"></a>00735 
<a name="l00736"></a>00736     <span class="comment">/* then push result */</span>
<a name="l00737"></a>00737     <a class="code" href="../../de/d07/bigdecimal_8c.html#a070409486cc2c3c246d56a4c0db26185">PUSH</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a8439f142d455ec7f89dcfc529474fc98">vstack</a>, tmp);
<a name="l00738"></a>00738     <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a1f5ed6eb5c79dc3282a92f54e918b7b6">debug</a>) {
<a name="l00739"></a>00739         <a class="code" href="../../de/d07/bigdecimal_8c.html#a070409486cc2c3c246d56a4c0db26185">PUSH</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a057b5bc3450b324219ca9694e1d03907">tstack</a>, reduce_to);
<a name="l00740"></a>00740         <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a6a973fe624aa9aa9ba0cdeb6792d3187" title="Calls a method.">rb_funcall</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a5ab1ad36b90babc760699b47da3403e1">parser</a>, <a class="code" href="../../dc/d0c/cparse_8c.html#acdc6520f31410be6234a6feaa7d20373">id_d_reduce</a>,
<a name="l00741"></a>00741                    4, tmp_t, reduce_to, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a057b5bc3450b324219ca9694e1d03907">tstack</a>, v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a8439f142d455ec7f89dcfc529474fc98">vstack</a>);
<a name="l00742"></a>00742     }
<a name="l00743"></a>00743 
<a name="l00744"></a>00744     <span class="comment">/* calculate transition state */</span>
<a name="l00745"></a>00745     <span class="keywordflow">if</span> (<a class="code" href="../../d8/df4/generator_8h.html#ae988773ed219452578f881fc7189c486">RARRAY_LEN</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a23011040bbcce8a521e1edd97e7f8d36">state</a>) == 0)
<a name="l00746"></a>00746         <a class="code" href="../../db/dcc/error_8c.html#a0f771a2840561f1838169b3d7d4616f3">rb_raise</a>(<a class="code" href="../../dc/d0c/cparse_8c.html#a384ab0d8c22f55bff306d4357d7b0482">RaccBug</a>, <span class="stringliteral">&quot;state stack unexpectedly empty&quot;</span>);
<a name="l00747"></a>00747     k2 = <a class="code" href="../../dc/d0c/cparse_8c.html#a1d29c991a29cc368e49bfa491533c9c2">num_to_long</a>(<a class="code" href="../../dc/d0c/cparse_8c.html#a1c3e8e57f54d4a4caf5cbfef9a85cb69">LAST_I</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a23011040bbcce8a521e1edd97e7f8d36">state</a>));
<a name="l00748"></a>00748     k1 = <a class="code" href="../../dc/d0c/cparse_8c.html#a1d29c991a29cc368e49bfa491533c9c2">num_to_long</a>(reduce_to) - v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a90e41fcba354aaec8301f0e22ed4b5e6">nt_base</a>;
<a name="l00749"></a>00749     <a class="code" href="../../dc/d0c/cparse_8c.html#a999aa703b22abcfb932f3baaeaec0f4a">D_printf</a>(<span class="stringliteral">&quot;(goto) k1=%ld\n&quot;</span>, k1);
<a name="l00750"></a>00750     <a class="code" href="../../dc/d0c/cparse_8c.html#a999aa703b22abcfb932f3baaeaec0f4a">D_printf</a>(<span class="stringliteral">&quot;(goto) k2=%ld\n&quot;</span>, k2);
<a name="l00751"></a>00751 
<a name="l00752"></a>00752     tmp = <a class="code" href="../../dc/d0c/cparse_8c.html#a2c5302305d878024276c413652549eb9">AREF</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#abf10f0546f4fd80796daaf4305cfa620">goto_pointer</a>, k1);
<a name="l00753"></a>00753     <span class="keywordflow">if</span> (<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a4832bad8845a35fc50f7a160901854a1">NIL_P</a>(tmp)) <span class="keywordflow">goto</span> notfound;
<a name="l00754"></a>00754 
<a name="l00755"></a>00755     i = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a93f154f3dcc08027f475bf0c3cc287bd">NUM2LONG</a>(tmp) + k2;
<a name="l00756"></a>00756     <a class="code" href="../../dc/d0c/cparse_8c.html#a999aa703b22abcfb932f3baaeaec0f4a">D_printf</a>(<span class="stringliteral">&quot;(goto) i=%ld\n&quot;</span>, i);
<a name="l00757"></a>00757     <span class="keywordflow">if</span> (i &lt; 0) <span class="keywordflow">goto</span> notfound;
<a name="l00758"></a>00758 
<a name="l00759"></a>00759     goto_state = <a class="code" href="../../dc/d0c/cparse_8c.html#a2c5302305d878024276c413652549eb9">AREF</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#aebb4301cbc7097fef44beb85c87028f5">goto_table</a>, i);
<a name="l00760"></a>00760     <span class="keywordflow">if</span> (<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a4832bad8845a35fc50f7a160901854a1">NIL_P</a>(goto_state)) {
<a name="l00761"></a>00761         <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;(goto) table[i] == nil&quot;</span>);
<a name="l00762"></a>00762         <span class="keywordflow">goto</span> notfound;
<a name="l00763"></a>00763     }
<a name="l00764"></a>00764     <a class="code" href="../../dc/d0c/cparse_8c.html#a999aa703b22abcfb932f3baaeaec0f4a">D_printf</a>(<span class="stringliteral">&quot;(goto) table[i]=%ld (goto_state)\n&quot;</span>, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a93f154f3dcc08027f475bf0c3cc287bd">NUM2LONG</a>(goto_state));
<a name="l00765"></a>00765 
<a name="l00766"></a>00766     tmp = <a class="code" href="../../dc/d0c/cparse_8c.html#a2c5302305d878024276c413652549eb9">AREF</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a85a7c77cae6772f8fbf3058404511f50">goto_check</a>, i);
<a name="l00767"></a>00767     <span class="keywordflow">if</span> (<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a4832bad8845a35fc50f7a160901854a1">NIL_P</a>(tmp)) {
<a name="l00768"></a>00768         <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;(goto) check[i] == nil&quot;</span>);
<a name="l00769"></a>00769         <span class="keywordflow">goto</span> notfound;
<a name="l00770"></a>00770     }
<a name="l00771"></a>00771     <span class="keywordflow">if</span> (tmp != <a class="code" href="../../dc/d0c/cparse_8c.html#af1afba1194a12547a1e65d92abf03b03">LONG2NUM</a>(k1)) {
<a name="l00772"></a>00772         <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;(goto) check[i] != table[i]&quot;</span>);
<a name="l00773"></a>00773         <span class="keywordflow">goto</span> notfound;
<a name="l00774"></a>00774     }
<a name="l00775"></a>00775     <a class="code" href="../../dc/d0c/cparse_8c.html#a999aa703b22abcfb932f3baaeaec0f4a">D_printf</a>(<span class="stringliteral">&quot;(goto) check[i]=%ld\n&quot;</span>, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a93f154f3dcc08027f475bf0c3cc287bd">NUM2LONG</a>(tmp));
<a name="l00776"></a>00776 
<a name="l00777"></a>00777     <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;(goto) found&quot;</span>);
<a name="l00778"></a>00778   transit:
<a name="l00779"></a>00779     <a class="code" href="../../de/d07/bigdecimal_8c.html#a070409486cc2c3c246d56a4c0db26185">PUSH</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a23011040bbcce8a521e1edd97e7f8d36">state</a>, goto_state);
<a name="l00780"></a>00780     v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a470e16b3d782757846c3481ddcf87e80">curstate</a> = <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a93f154f3dcc08027f475bf0c3cc287bd">NUM2LONG</a>(goto_state);
<a name="l00781"></a>00781     <span class="keywordflow">return</span> <a class="code" href="../../de/de6/ruby_2ruby_8h.html#ac55fae7f748afd3fc2533d0d7d06cf5a">INT2FIX</a>(0);
<a name="l00782"></a>00782 
<a name="l00783"></a>00783   notfound:
<a name="l00784"></a>00784     <a class="code" href="../../dc/d0c/cparse_8c.html#a51752358f6d343843572e01a177bfbd4">D_puts</a>(<span class="stringliteral">&quot;(goto) not found: use default&quot;</span>);
<a name="l00785"></a>00785     <span class="comment">/* overwrite `goto-state&apos; by default value */</span>
<a name="l00786"></a>00786     goto_state = <a class="code" href="../../dc/d0c/cparse_8c.html#a2c5302305d878024276c413652549eb9">AREF</a>(v-&gt;<a class="code" href="../../d2/d6a/structcparse__params.html#a7fe1eb04943a6ca4a031ccc20b6fb444">goto_default</a>, k1);
<a name="l00787"></a>00787     <span class="keywordflow">goto</span> transit;
<a name="l00788"></a>00788 }
<a name="l00789"></a>00789 
<a name="l00790"></a>00790 <span class="comment">/* -----------------------------------------------------------------------</span>
<a name="l00791"></a>00791 <span class="comment">                          Ruby Interface</span>
<a name="l00792"></a>00792 <span class="comment">----------------------------------------------------------------------- */</span>
<a name="l00793"></a>00793 
<a name="l00794"></a>00794 <span class="keywordtype">void</span>
<a name="l00795"></a><a class="code" href="../../dc/d0c/cparse_8c.html#a67e08292e804dfb240a8cf614b7c7ac3">00795</a> <a class="code" href="../../dc/d0c/cparse_8c.html#a67e08292e804dfb240a8cf614b7c7ac3">Init_cparse</a>(<span class="keywordtype">void</span>)
<a name="l00796"></a>00796 {
<a name="l00797"></a>00797     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a3c1d4bfc6a81af60bdcb48744c35f760">VALUE</a> Racc, Parser;
<a name="l00798"></a>00798     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#afa5b9137f051ac26d7ccc8824f178233">ID</a> id_racc = <a class="code" href="../../dc/dcc/array_8c.html#a9cfa42d4b79c89d68c53be8b2150a503">rb_intern</a>(<span class="stringliteral">&quot;Racc&quot;</span>);
<a name="l00799"></a>00799 
<a name="l00800"></a>00800     <span class="keywordflow">if</span> (<a class="code" href="../../db/d2e/intern_8h.html#afaaee0b4c292ab56ca8acee9fad1242b">rb_const_defined</a>(<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a57c96ead3ef230b4838e65fe037c346e">rb_cObject</a>, id_racc)) {
<a name="l00801"></a>00801         Racc = <a class="code" href="../../db/d2e/intern_8h.html#a17a81c1a7d754e5ab49fc4b4369b6c8c">rb_const_get</a>(<a class="code" href="../../de/de6/ruby_2ruby_8h.html#a57c96ead3ef230b4838e65fe037c346e">rb_cObject</a>, id_racc);
<a name="l00802"></a>00802         Parser = <a class="code" href="../../db/d2e/intern_8h.html#a8265931c0ae8ab5c2e40702295049439">rb_const_get_at</a>(Racc, <a class="code" href="../../dc/dcc/array_8c.html#a9cfa42d4b79c89d68c53be8b2150a503">rb_intern</a>(<span class="stringliteral">&quot;Parser&quot;</span>));
<a name="l00803"></a>00803     }
<a name="l00804"></a>00804     <span class="keywordflow">else</span> {
<a name="l00805"></a>00805         Racc = <a class="code" href="../../de/ddf/group__class.html#ga911071d40f9312e49a774ea0e1b12869">rb_define_module</a>(<span class="stringliteral">&quot;Racc&quot;</span>);
<a name="l00806"></a>00806         Parser = <a class="code" href="../../de/ddf/group__class.html#ga5266deadce0318d830a1e63c0933b898" title="Defines a class under the namespace of outer.">rb_define_class_under</a>(Racc, <span class="stringliteral">&quot;Parser&quot;</span>, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a57c96ead3ef230b4838e65fe037c346e">rb_cObject</a>);
<a name="l00807"></a>00807     }
<a name="l00808"></a>00808     <a class="code" href="../../d7/d19/group__defmethod.html#ga69c4f84891831d013e9e64972de90d78">rb_define_private_method</a>(Parser, <span class="stringliteral">&quot;_racc_do_parse_c&quot;</span>, <a class="code" href="../../dc/d0c/cparse_8c.html#ae945376ef8cf004f20dda6002164bed5">racc_cparse</a>, 2);
<a name="l00809"></a>00809     <a class="code" href="../../d7/d19/group__defmethod.html#ga69c4f84891831d013e9e64972de90d78">rb_define_private_method</a>(Parser, <span class="stringliteral">&quot;_racc_yyparse_c&quot;</span>, <a class="code" href="../../dc/d0c/cparse_8c.html#a0a46104fc0afced976fd3c4887ee56f7">racc_yyparse</a>, 4);
<a name="l00810"></a>00810     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a861b20872f7d24f1c5f2da5261037322">rb_define_const</a>(Parser, <span class="stringliteral">&quot;Racc_Runtime_Core_Version_C&quot;</span>,
<a name="l00811"></a>00811                     <a class="code" href="../../db/d2e/intern_8h.html#a03acd62c0b1edebbe1d61f957c19b7ac">rb_str_new2</a>(<a class="code" href="../../dc/d0c/cparse_8c.html#a5c066a677833ce5c349a97b1481cedbb">RACC_VERSION</a>));
<a name="l00812"></a>00812     <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a861b20872f7d24f1c5f2da5261037322">rb_define_const</a>(Parser, <span class="stringliteral">&quot;Racc_Runtime_Core_Id_C&quot;</span>,
<a name="l00813"></a>00813         <a class="code" href="../../db/d2e/intern_8h.html#a03acd62c0b1edebbe1d61f957c19b7ac">rb_str_new2</a>(<span class="stringliteral">&quot;$originalId: cparse.c,v 1.8 2006/07/06 11:39:46 aamine Exp $&quot;</span>));
<a name="l00814"></a>00814 
<a name="l00815"></a>00815     <a class="code" href="../../dc/d0c/cparse_8c.html#ae670e17dbe6d63fad0031752be7c6c32">CparseParams</a> = <a class="code" href="../../de/ddf/group__class.html#ga5266deadce0318d830a1e63c0933b898" title="Defines a class under the namespace of outer.">rb_define_class_under</a>(Racc, <span class="stringliteral">&quot;CparseParams&quot;</span>, <a class="code" href="../../de/de6/ruby_2ruby_8h.html#a57c96ead3ef230b4838e65fe037c346e">rb_cObject</a>);
<a name="l00816"></a>00816 
<a name="l00817"></a>00817     <a class="code" href="../../dc/d0c/cparse_8c.html#a384ab0d8c22f55bff306d4357d7b0482">RaccBug</a> = <a class="code" href="../../db/dcc/error_8c.html#a95ad3953d535707e2cf2b1d837f5e253">rb_eRuntimeError</a>;
<a name="l00818"></a>00818 
<a name="l00819"></a>00819     <a class="code" href="../../dc/d0c/cparse_8c.html#af4d1e2269c213f3cff294b1a19cd8733">id_yydebug</a>      = <a class="code" href="../../dc/dcc/array_8c.html#a9cfa42d4b79c89d68c53be8b2150a503">rb_intern</a>(<span class="stringliteral">&quot;@yydebug&quot;</span>);
<a name="l00820"></a>00820     <a class="code" href="../../dc/d0c/cparse_8c.html#a834be3eb5e540250a42734d7f4add8c2">id_nexttoken</a>    = <a class="code" href="../../dc/dcc/array_8c.html#a9cfa42d4b79c89d68c53be8b2150a503">rb_intern</a>(<span class="stringliteral">&quot;next_token&quot;</span>);
<a name="l00821"></a>00821     <a class="code" href="../../dc/d0c/cparse_8c.html#ab3cf40d11f0dca0181034720feb0a83d">id_onerror</a>      = <a class="code" href="../../dc/dcc/array_8c.html#a9cfa42d4b79c89d68c53be8b2150a503">rb_intern</a>(<span class="stringliteral">&quot;on_error&quot;</span>);
<a name="l00822"></a>00822     <a class="code" href="../../dc/d0c/cparse_8c.html#a6800221fc9e6149fb97eeafc1e84947d">id_noreduce</a>     = <a class="code" href="../../dc/dcc/array_8c.html#a9cfa42d4b79c89d68c53be8b2150a503">rb_intern</a>(<span class="stringliteral">&quot;_reduce_none&quot;</span>);
<a name="l00823"></a>00823     <a class="code" href="../../dc/d0c/cparse_8c.html#a81ab42d71c85cea1f094aa863dec2712">id_errstatus</a>    = <a class="code" href="../../dc/dcc/array_8c.html#a9cfa42d4b79c89d68c53be8b2150a503">rb_intern</a>(<span class="stringliteral">&quot;@racc_error_status&quot;</span>);
<a name="l00824"></a>00824 
<a name="l00825"></a>00825     <a class="code" href="../../dc/d0c/cparse_8c.html#a23878f80efaea8fbf95436cdf58b84cd">id_d_shift</a>       = <a class="code" href="../../dc/dcc/array_8c.html#a9cfa42d4b79c89d68c53be8b2150a503">rb_intern</a>(<span class="stringliteral">&quot;racc_shift&quot;</span>);
<a name="l00826"></a>00826     <a class="code" href="../../dc/d0c/cparse_8c.html#acdc6520f31410be6234a6feaa7d20373">id_d_reduce</a>      = <a class="code" href="../../dc/dcc/array_8c.html#a9cfa42d4b79c89d68c53be8b2150a503">rb_intern</a>(<span class="stringliteral">&quot;racc_reduce&quot;</span>);
<a name="l00827"></a>00827     <a class="code" href="../../dc/d0c/cparse_8c.html#a83eb2a82ce7b62c5d197b3077750e034">id_d_accept</a>      = <a class="code" href="../../dc/dcc/array_8c.html#a9cfa42d4b79c89d68c53be8b2150a503">rb_intern</a>(<span class="stringliteral">&quot;racc_accept&quot;</span>);
<a name="l00828"></a>00828     <a class="code" href="../../dc/d0c/cparse_8c.html#a8a92a5a5a571730aefae6ac864ff80cf">id_d_read_token</a>  = <a class="code" href="../../dc/dcc/array_8c.html#a9cfa42d4b79c89d68c53be8b2150a503">rb_intern</a>(<span class="stringliteral">&quot;racc_read_token&quot;</span>);
<a name="l00829"></a>00829     <a class="code" href="../../dc/d0c/cparse_8c.html#aeae35d86a3ea05fc3831156492e8427e">id_d_next_state</a>  = <a class="code" href="../../dc/dcc/array_8c.html#a9cfa42d4b79c89d68c53be8b2150a503">rb_intern</a>(<span class="stringliteral">&quot;racc_next_state&quot;</span>);
<a name="l00830"></a>00830     <a class="code" href="../../dc/d0c/cparse_8c.html#a2de7e7e741e5e52a250760fd2e3f815a">id_d_e_pop</a>       = <a class="code" href="../../dc/dcc/array_8c.html#a9cfa42d4b79c89d68c53be8b2150a503">rb_intern</a>(<span class="stringliteral">&quot;racc_e_pop&quot;</span>);
<a name="l00831"></a>00831 }
<a name="l00832"></a>00832 
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 1 Mar 2013 for Ruby by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
